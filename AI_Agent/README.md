# 整合 LLM 模型的 AI Agent

歡迎來到 n8n AI Agent 教學！這裡提供了一系列從基礎到進階的實作範例，幫助您學習如何將 Ollama（本地模型）、OpenAI、Claude、Gemini 等大型語言模型整合到 n8n 工作流程中，建立智能化的自動化系統。

**💡 學習路線選擇**：
- 🆓 **零成本入門**：從 Ollama 本地模型開始，無需 API 金鑰
- 💳 **雲端進階**：使用 OpenAI、Gemini 等雲端服務，獲得更好的效能

## 📚 什麼是 AI Agent？

**AI Agent** 是一個能夠自主思考、決策和行動的 AI 系統：
- **理解**：理解用戶的需求和意圖
- **決策**：決定如何處理任務
- **行動**：執行操作並取得結果
- **學習**：從互動中持續改進

透過 n8n 的 AI Agent 節點，您可以建立各種智能化的自動化系統，從簡單的聊天機器人到複雜的多代理協作系統。

## 🎯 學習階段規劃

本教學分為四個階段，從基礎入門到最佳實踐：

### **階段一：基礎入門**
學習 AI Agent 的基本概念和操作，建立簡單的聊天機器人和問答系統。

### **階段二：中階應用**
學習工具使用和實際業務應用，建立能夠執行實際操作的 AI 助理。

### **階段三：進階實戰**
學習多代理協作和企業級應用設計，建立複雜的 AI 系統。

### **階段四：最佳實踐**
學習監控、優化和安全管理，確保 AI 系統的品質和可靠性。

---

## 🚀 開始之前：安裝 Ollama（零成本入門）

如果您想從零成本的本地模型開始學習，建議先安裝 Ollama。這樣您可以立即開始實作，無需申請任何 API 金鑰。

### **什麼是 Ollama？**

Ollama 是一個讓您在本地電腦運行大型語言模型的工具，具有以下優勢：
- ✅ **完全免費**：無需支付 API 使用費用
- ✅ **隱私保護**：資料不會傳送到外部伺服器
- ✅ **離線運作**：不需要網路連線即可使用
- ✅ **簡單易用**：幾個指令即可完成安裝

### **系統需求**

- **作業系統**：macOS、Linux 或 Windows
- **記憶體**：建議至少 8GB RAM（16GB 更佳）
- **硬碟空間**：至少 10GB 可用空間
- **處理器**：支援 AVX2 指令集的 CPU

### **安裝步驟**

#### **macOS 安裝**

使用 Homebrew 安裝（推薦）：
```bash
brew install ollama
```

或從官網下載安裝程式：
1. 前往 [Ollama 官網](https://ollama.ai)
2. 下載 macOS 安裝程式
3. 執行安裝程式並依照指示完成安裝

#### **Linux 安裝**

執行一行安裝指令：
```bash
curl -fsSL https://ollama.ai/install.sh | sh
```

#### **Windows 安裝**

1. 前往 [Ollama 官網](https://ollama.ai)
2. 下載 Windows 安裝程式
3. 執行安裝程式並依照指示完成安裝

### **啟動 Ollama 服務**

安裝完成後，啟動 Ollama 服務：

```bash
ollama serve
```

服務會在 `http://localhost:11434` 運行。

### **下載推薦的 LLM 模型**

為了配合本教學的第一個範例，建議下載以下模型：

#### **選項一：gpt-oss:20b**（教學範例使用）
```bash
ollama pull gpt-oss:20b
```
- 模型大小：約 12GB
- 適合：一般對話和工具使用
- 需要記憶體：約 16GB RAM

#### **選項二：llama2:7b**（輕量級選擇）
```bash
ollama pull llama2:7b
```
- 模型大小：約 4GB
- 適合：記憶體較少的電腦
- 需要記憶體：約 8GB RAM

#### **選項三：mistral:7b**（推薦平衡選擇）
```bash
ollama pull mistral:7b
```
- 模型大小：約 4GB
- 適合：效能與品質的平衡
- 需要記憶體：約 8GB RAM

### **驗證安裝**

下載完成後，驗證模型是否可用：

```bash
# 列出已安裝的模型
ollama list

# 測試模型（以 llama2:7b 為例）
ollama run llama2:7b "你好，請自我介紹"
```

### **在 n8n 中設定 Ollama**

1. **新增 Ollama 憑證**
   - 在 n8n 中點擊「Credentials」
   - 選擇「Ollama API」
   - Base URL 設定為：`http://localhost:11434`
   - 儲存憑證

2. **選擇模型**
   - 在工作流程中加入「Ollama Chat Model」節點
   - 選擇您剛才下載的模型名稱
   - 連接到 AI Agent 節點

### **常見問題**

**Q: Ollama 無法啟動怎麼辦？**
- 檢查是否有其他程式佔用 11434 port
- 確認防火牆設定允許本地連線
- 重新安裝 Ollama

**Q: 模型下載很慢？**
- 模型檔案較大，請耐心等待
- 確保網路連線穩定
- 可以使用較小的模型（如 llama2:7b）

**Q: 記憶體不足怎麼辦？**
- 選擇較小的模型（7b 參數版本）
- 關閉其他應用程式釋放記憶體
- 考慮使用雲端 API（OpenAI、Gemini）

### **💡 提示**

- 如果您的電腦配置較低，可以跳過 Ollama 安裝，直接從「智能客服聊天機器人」範例開始，使用雲端 API
- Ollama 適合學習和開發，生產環境建議使用雲端 API 以獲得更穩定的效能
- 您可以隨時在 Ollama 和雲端 API 之間切換，只需更換 Chat Model 節點即可

---

## 📚 實作範例導覽

### **階段一：基礎入門**

#### [⭐ 範例一：智能客服聊天機器人](./智能客服聊天機器人/README.md)
**難度**: ⭐☆☆ (初級) | **學習時間**: 30-45 分鐘

**從這裡開始！** 理解 AI Agent 基本架構，學習如何建立一個能夠進行對話的智能客服系統。這是最基礎的範例，專注於純對話功能。

**學習重點**：
- AI Agent 的基本工作流程（接收、理解、回應）
- System Prompt（系統提示詞）的設計
- 對話記憶的重要性與運作方式
- Chat Model 的選擇與設定（支援 Ollama 和 OpenAI）

**使用節點**：Chat Trigger、AI Agent、OpenAI Chat Model（或 Ollama Chat Model）、Window Buffer Memory

**💡 為什麼從這裡開始？**
- ✅ 最簡單的 AI Agent 實作，只專注於對話
- ✅ 支援 Ollama 本地模型（零成本）和雲端 API
- ✅ 建立完整的 AI Agent 基礎概念
- ✅ 快速上手，立即看到成果

---

#### [⭐ 範例二：天氣和新聞查詢（使用 Ollama）](./天氣和新聞查詢_使用Ollama/README.md)
**難度**: ⭐⭐☆ (初級到中級) | **學習時間**: 45-60 分鐘

**加入工具使用能力！** 在掌握基本對話後，學習如何讓 AI Agent 具備工具使用能力，能夠查詢即時天氣和最新新聞。

**學習重點**：
- **工具使用的核心概念**：AI 如何選擇和使用工具
- **外部 API 整合**：HTTP Request Tool 的使用
- **RSS 資料讀取**：RSS Feed Read Tool 的應用
- **多工具協作**：AI 在多個工具間做選擇
- 持續使用 Ollama 本地模型（零成本）

**使用節點**：Chat Trigger、AI Agent、Ollama Chat Model、Window Buffer Memory、HTTP Request Tool、RSS Feed Read Tool

**💡 為什麼學習這個範例？**
- ✅ 從純對話進階到工具使用
- ✅ 學習 AI Agent 的核心能力：工具選擇
- ✅ 實用功能：天氣和新聞查詢
- ✅ 持續零成本學習（使用 Ollama）

---

#### [⭐ 範例三：RAG 智能問答系統](./RAG智能問答系統/README.md)
**難度**: ⭐⭐☆ (中級) | **學習時間**: 60-120 分鐘

**學習 RAG 技術！** 從最簡單的記憶體儲存開始，逐步掌握向量資料庫和語義搜尋，建立能夠從文件中檢索資訊並回答問題的智能問答系統。

**學習重點**：
- 什麼是 RAG（檢索增強生成）
- Embeddings（嵌入）的概念與應用
- Vector Store（向量資料庫）的三種實作方式
- 從記憶體儲存到雲端資料庫的演進
- 語義搜尋的工作原理
- 分離式架構設計
- 多來源文件整合

**三個子範例**（循序漸進）：
1. **🟢 入門版 - 記憶體儲存**（⭐☆☆，45 分鐘）
   - In-Memory Vector Store（最簡單，適合快速體驗）
   - 單一工作流程整合式設計
   - 零成本快速上手
   
2. **🟡 基礎版 - 簡單向量儲存**（⭐⭐☆，90-120 分鐘）
   - Simple Vector Store（持久化儲存，適合實際應用）
   - 分離式架構（索引和查詢分開）
   - 多來源整合（本機 + Google Drive）
   - 來源過濾功能
   
3. **🔴 進階版 - 雲端向量資料庫**（⭐⭐⭐，4-6 小時，開發中）
   - Pinecone / Qdrant（企業級應用）
   - 大規模文件管理
   - 混合搜尋、權限管理

**使用節點**：Form Trigger、Chat Trigger、AI Agent、Vector Store (多種)、Embeddings、Document Loader、Google Drive

**💡 為什麼學習這個範例？**
- ✅ 循序漸進：從簡單到複雜，三個版本完整學習
- ✅ 實用技能：RAG 是 AI Agent 最重要的應用之一
- ✅ 靈活選擇：根據需求選擇合適的儲存方式
- ✅ 企業應用：基礎版和進階版適合實際部署

---

### **階段二：中階應用**

#### [⭐⭐ 範例四：具備工具使用能力的助理](./具備工具使用能力的助理/README.md)
**難度**: ⭐⭐☆ (中級) | **學習時間**: 45-60 分鐘

**進階工具整合！** 讓 AI 能夠執行更複雜的操作，學習如何使用雲端 API 建立一個具備多種工具使用能力的 AI 助理。

**學習重點**：
- Tools Agent 的進階運作方式
- AI 如何在多個工具間智能選擇
- 自訂工具的建立與整合
- 從 Ollama 過渡到雲端 API（OpenAI）

**使用節點**：AI Agent (Tools Agent)、Calculator Tool、Call n8n Workflow Tool、HTTP Request Tool

---

#### [⭐⭐ 範例五：郵件智能分類系統](./郵件智能分類系統/README.md)
**難度**: ⭐⭐☆ (中級) | **學習時間**: 45-60 分鐘

**實際業務應用！** 學習實際業務應用場景，建立一個能夠自動分類郵件的智能系統。

**學習重點**：
- 自動化業務流程設計
- Prompt Engineering（提示詞工程）進階技巧
- 多節點協作與資料流轉
- 實際業務場景的應用

**使用節點**：Gmail Trigger、AI Agent、Text Classifier、Google Sheets

---

### **階段三：進階實戰**

#### [⭐⭐⭐ 範例六：多代理協作系統（Multi-Agent）](./多代理協作系統/README.md)
**難度**: ⭐⭐⭐ (進階) | **學習時間**: 60-90 分鐘

**建立 AI 團隊！** 建立專業分工的 AI 團隊，學習如何設計和實作多代理協作系統。

**學習重點**：
- 多代理系統架構設計
- 代理之間的溝通與協作機制
- 任務委派與分工策略
- 複雜問題的分解處理

**使用節點**：AI Agent（主管理者）、AI Agent Tool（專業代理）、多個 Chat Model

---

#### [⭐⭐⭐ 範例七：客戶服務自動化平台](./客戶服務自動化平台/README.md)
**難度**: ⭐⭐⭐ (進階) | **學習時間**: 90-120 分鐘

**企業級應用！** 建立完整的端到端解決方案，學習如何設計企業級的客戶服務自動化平台。

**學習重點**：
- 企業級應用架構設計
- 多渠道整合（網頁、郵件、即時通訊）
- 人機協作流程設計
- 數據持久化與管理

**使用節點**：Webhook、AI Agent、Vector Store Retriever、Switch、Supabase

---

### **階段四：最佳實踐**

#### [⭐⭐⭐ 範例八：AI Agent 監控與優化](./AI_Agent監控與優化/README.md)
**難度**: ⭐⭐⭐ (進階) | **學習時間**: 60-90 分鐘

**品質與安全！** 學習 AI Agent 的最佳實踐，包括監控、評估、優化和安全管理。

**學習重點**：
- 使用 Guardrails 確保輸出安全與合規
- Evaluation 測試與評估 Agent 表現
- 成本監控與 Token 使用優化
- Prompt 版本管理與 A/B 測試

**使用節點**：Guardrails、Evaluation、監控節點

---

## 🎯 學習路徑建議

### **推薦學習順序**

建議按照以下順序學習這些範例，循序漸進掌握 AI Agent 開發：

1. **範例一：智能客服聊天機器人** 
   - ✅ **從這裡開始！** 最基礎的對話功能
   - 建立 AI Agent 核心概念
   - 支援 Ollama（零成本）或 OpenAI

2. **範例二：天氣和新聞查詢（使用 Ollama）** 
   - 加入工具使用能力
   - 學習 AI 如何選擇和使用工具
   - 持續零成本學習

3. **範例三：RAG 智能問答系統** 
   - 從入門版開始：快速體驗 RAG 技術
   - 進階到基礎版：掌握持久化儲存和實用架構
   - 學習向量資料庫和語義搜尋

4. **範例四：具備工具使用能力的助理** 
   - 進階工具整合與選擇機制
   - 過渡到雲端 API

5. **範例五：郵件智能分類系統** 
   - 學習實際業務應用場景
   - Prompt Engineering 進階技巧

6. **範例六：多代理協作系統** 
   - 學習進階架構設計
   - 多代理協作機制

7. **範例七：客戶服務自動化平台** 
   - 企業級應用完整設計
   - 端到端解決方案

8. **範例八：AI Agent 監控與優化** 
   - 最佳實踐與系統優化
   - 品質保證與安全管理

## 💡 學習建議

- **循序漸進**：每個範例都建立在前一個的基礎上，建議按順序學習
- **動手實作**：下載範例工作流程並實際執行，觀察每個節點的運作
- **理解概念**：理解 AI Agent 的核心概念，而不只是操作步驟
- **持續優化**：根據實際需求調整和優化系統

## 🎯 每個範例的標準結構

### **教學流程：**
1. **需求說明**（5 分鐘）- 了解範例的目的和應用場景
2. **架構設計**（10 分鐘）- 規劃系統架構與資料流程
3. **逐步建置**（30 分鐘）- 邊做邊講解，建立完整流程
4. **測試與除錯**（10 分鐘）- 測試系統並解決問題
5. **優化建議**（5 分鐘）- 提供進階優化方向

## 📦 配套教材建議

### 1. **課前準備文件**
- n8n 帳號註冊教學
- Ollama 安裝與設定指南（零成本入門選項）
- OpenAI / Google API Key 申請指南（進階使用）
- 基礎概念說明（LLM、Prompt、Token、AI Agent）

### 2. **實作範本**
- 每個範例的 JSON workflow 檔案
- Prompt 範本庫
- 常見錯誤排除清單

### 3. **作業設計**
- **基礎**：修改 System Prompt 改變 Agent 性格
- **中階**：整合一個新的 API 工具
- **進階**：設計並實作自己的多代理系統

## 📚 相關資源

- [n8n AI Agent 文件](https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.agent/)
- [OpenAI API 文件](https://platform.openai.com/docs)
- [Google Gemini API 文件](https://ai.google.dev/docs)
- [n8n 官方文件](https://docs.n8n.io/)

---

**🎓 完成這些範例後，您將能夠建立各種智能化的自動化系統，從簡單的聊天機器人到複雜的企業級 AI 平台！**
