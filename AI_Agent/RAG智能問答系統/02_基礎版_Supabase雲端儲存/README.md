# 📁 RAG 基礎版 - Supabase 雲端儲存

## 📖 什麼是這個範例？

這是 **最快速部署的 RAG 實作**，使用 **Supabase** 雲端向量資料庫，**5 分鐘即可完成設定**，零技術門檻！

這個版本包含 **4 個獨立工作流程**：
- 📤 **Workflow 1A**：本機檔案上傳索引
- ☁️ **Workflow 1B**：Google Drive 自動同步
- 💬 **Workflow 2A**：基礎版智能問答
- 🎯 **Workflow 2B**：進階版問答（來源過濾）

## ✨ 為什麼選擇 Supabase？

| 特點 | 說明 | 優勢 |
|------|------|------|
| ⚡ **超快設定** | 快速完成 | 不需要安裝任何軟體 |
| 🎨 **視覺化管理** | 提供管理介面 | 不需要使用終端機 |
| 🆓 **免費額度** | 500MB 空間 | 約可儲存 40,000 份文件 |
| 🔄 **自動備份** | 資料每日備份 | 不用擔心資料遺失 |
| 🌐 **隨處存取** | 雲端儲存 | 不受本地網路限制 |
| 🛡️ **企業級安全** | 自動加密 | ISO 27001 認證 |

## 🆚 與其他版本的差異

| 特性 | 入門版 | 基礎版（Supabase） | 進階版（PostgreSQL） |
|------|--------|-------------------|-------------------|
| **儲存方式** | 記憶體 | Supabase 雲端 | PostgreSQL 本地 |
| **設定複雜度** | 🟢 零設定 | **🟢 簡單** | 🟡 中等 |
| **技術門檻** | 🟢 零門檻 | **🟢 零門檻** | 🟡 需要終端機 |
| **資料持久性** | ❌ | ✅ | ✅ |
| **管理介面** | ❌ | **✅ 視覺化** | ❌ 終端機 |
| **資料控制** | 本地 | ⚠️ 雲端 | ✅ 100% 本地 |
| **成本** | 免費 | **免費額度** | 完全免費 |
| **適用規模** | <50 文件 | **<1000 文件** | 無限制 |

## 🎯 核心優勢

### **1. 最快速的設定體驗**

```
傳統方式：
├─ 安裝 PostgreSQL
├─ 安裝 PGVector
├─ 設定資料庫
└─ 總計：較複雜 + 可能遇到問題

Supabase 方式：
├─ 註冊帳號
├─ 建立專案
├─ 複製連線資訊
├─ 設定 n8n
└─ 總計：快速完成 ✅
```

### **2. 零技術門檻**

不需要：
- ❌ 終端機操作
- ❌ SQL 知識
- ❌ 資料庫管理經驗
- ❌ 除錯技能

只需要：
- ✅ 點擊幾個按鈕
- ✅ 複製貼上
- ✅ 完成！

### **3. 視覺化管理介面**

Supabase 提供完整的管理介面：
- 📊 查看所有儲存的文件
- 🔍 SQL 查詢編輯器
- 📈 使用量統計
- 🔄 自動備份管理
- 📝 資料表瀏覽器

### **4. 免費額度充足**

```
免費方案包含：
✅ 500MB 資料庫空間（約 40,000 份文件）
✅ 無限 API 請求
✅ 每月 2GB 資料傳輸
✅ 7 天自動備份
✅ 2 個專案
```

---

## 📦 包含的檔案

### **工作流程檔案**

1. **01_RAG文件索引_本機上傳.json**
   - 提供網頁表單上傳文件
   - 支援 PDF、Word、TXT 格式
   - 自動建立向量索引並儲存到 Supabase

2. **02_RAG文件索引_Google_Drive同步.json**
   - 從 Google Drive 資料夾同步文件
   - 支援排程自動執行
   - 保留完整檔案元資料

3. **03_RAG智能問答_基礎版.json**
   - 簡單易用的對話介面
   - 搜尋全部文件
   - 適合快速部署

4. **04_RAG智能問答_進階版_來源過濾.json**
   - 支援來源過濾功能
   - 智能識別查詢意圖
   - 更詳細的系統提示

### **設定指南檔案**

- **Supabase快速設定指南.md**：5 分鐘設定步驟（重點！）
- **升級到PGVector指南.md**：如果未來想遷移到本地
- **README.md**（本檔案）：概覽和說明
- **完整使用指南.md**：詳細的使用說明

### **測試資料檔案**

- `產品資訊.md` / `產品資訊.pdf`：測試用產品資料
- `說明書.txt`：測試用說明文件
- `快速參考卡.md`：快速參考資料

---

## 🚀 快速開始

### **前置需求**

- ✅ n8n 帳號（本地安裝或雲端版）
- ✅ Google Gemini API Key（[免費申請](https://aistudio.google.com/app/apikey)）
- ✅ 電子郵件帳號（用於註冊 Supabase）

### **步驟 1：建立 Supabase 帳號**

1. 前往 [https://supabase.com](https://supabase.com)
2. 點擊 **Start your project**
3. 使用 GitHub/Google 快速登入

### **步驟 2：建立專案**

1. 點擊 **New Project**
2. 填寫：
   - 專案名稱：`n8n-rag-system`
   - 資料庫密碼：[設定一個強密碼]
   - 地區：`Northeast Asia (Tokyo)`
3. 點擊 **Create new project**
4. 等待 30 秒

### **步驟 3：啟用 Vector 擴展**

1. 點擊左側 **SQL Editor**
2. 點擊 **New query**
3. 貼上並執行：

```sql
CREATE EXTENSION IF NOT EXISTS vector;
```

### **步驟 4：取得連線資訊**

1. 點擊 **Settings** → **Database**
2. 複製 **Connection string** (URI 格式)
3. 將 `[YOUR-PASSWORD]` 替換為您的密碼

### **步驟 5：在 n8n 設定憑證**

1. n8n → **Credentials** → **Add Credential**
2. 選擇 **Postgres**
3. 貼上連線字串
4. 測試連線 ✅
5. 儲存

### **步驟 6：匯入工作流程並開始使用**

1. 匯入 4 個 JSON 檔案
2. 更新所有 Vector Store 節點的憑證
3. 測試上傳功能
4. 開始問答！

**🎉 完成！設定很簡單！**

---

## 📖 詳細設定指南

**👉 請參考 [Supabase快速設定指南.md](./Supabase快速設定指南.md)**

這份指南包含：
- ✅ 詳細的設定步驟
- ✅ 常見問題解答
- ✅ 免費額度詳細說明
- ✅ 視覺化管理介面使用
- ✅ 疑難排解

---

## 🎯 使用場景

### **最適合 Supabase 的情況**

✅ **快速原型開發**
```
情境：老闆下週要看 Demo
解決：快速建立，馬上展示
```

✅ **小型團隊專案**
```
情境：3-5 人團隊，不想管理伺服器
解決：雲端自動管理，專注開發
```

✅ **學習和實驗**
```
情境：學習 RAG 技術
解決：免費額度充足，隨時實驗
```

✅ **預算有限**
```
情境：初創公司，控制成本
解決：免費開始，成長後付費
```

### **不太適合 Supabase 的情況**

⚠️ **資料不能外流**
```
問題：企業規定資料必須留在內部
建議：改用進階版（本地 PostgreSQL）
```

⚠️ **超大規模**
```
問題：需要儲存 >10,000 份文件
建議：考慮付費方案或本地部署
```

⚠️ **需要離線運作**
```
問題：需要在沒有網路的環境運作
建議：改用進階版（本地 PostgreSQL）
```

---

## 💰 成本管理

### **免費額度詳情**

| 資源 | 免費額度 | 實際可用量 |
|------|---------|----------|
| 📦 資料庫空間 | 500MB | 約 40,000 份文件 |
| 🔄 API 請求 | 無限 | 沒有限制 |
| 📥 資料傳輸 | 2GB/月 | 每月約 200,000 次查詢 |
| 💾 備份保留 | 7 天 | 自動每日備份 |

### **計算方式**

```
每份文件平均大小：
- 1-2 頁 PDF = 約 10-20KB
- 500MB = 25,000-50,000 份文件

每次查詢平均資料傳輸：
- 1 次查詢 = 約 10KB
- 2GB = 約 200,000 次查詢/月
```

### **超過免費額度會怎樣？**

1. Supabase 會發送電子郵件通知
2. 不會立即停止服務
3. 您可以選擇：
   - 升級到 Pro ($25/月)
   - 刪除舊資料
   - 匯出並遷移到本地

---

## 🔄 從 Supabase 遷移到本地

### **何時考慮遷移？**

- ✅ 資料量超過免費額度
- ✅ 需要完全控制資料
- ✅ 對成本有更嚴格的控制
- ✅ 需要客製化資料庫設定

### **如何遷移？**

**步驟 1：匯出資料**
```bash
pg_dump [Supabase 連線字串] > backup.sql
```

**步驟 2：設定本地 PostgreSQL**
```bash
# 安裝 PostgreSQL
brew install postgresql@17

# 建立資料庫
createdb n8n_rag_db
```

**步驟 3：匯入資料**
```bash
psql -d n8n_rag_db < backup.sql
```

**步驟 4：更新 n8n 憑證**
- 將連線資訊改為本地

**👉 完整步驟請參考 [升級到PGVector指南.md](./升級到PGVector指南.md)**

---

## 🎓 學習路徑

### **完成這個版本後，您已經學會：**

✅ 雲端向量資料庫的使用  
✅ 快速部署 RAG 系統的方法  
✅ 視覺化管理介面的使用  
✅ 成本控制和額度管理  
✅ 分離式架構的設計

### **下一步學習建議：**

1. **繼續使用 Supabase**
   - 優化查詢效能
   - 實作更多進階功能
   - 學習 SQL 查詢

2. **升級到本地 PostgreSQL**（[進階版](../03_進階版_本地PostgreSQL/README.md)）
   - 完全掌控資料
   - 零成本無限制
   - 學習資料庫管理

---

## ❓ 常見問題

### **Q1: Supabase 安全嗎？**

**非常安全！**
- ✅ 企業級加密
- ✅ ISO 27001 認證
- ✅ SOC 2 Type II 認證
- ✅ 符合 GDPR

### **Q2: 免費額度夠用嗎？**

**對大多數情況夠用：**
- ✅ 學習和實驗：完全夠用
- ✅ 小型專案（<1000 文件）：夠用
- ⚠️ 大型專案：可能需要付費

### **Q3: 資料會被 Supabase 看到嗎？**

**不會！**
- ✅ 資料加密儲存
- ✅ Supabase 員工無法存取
- ✅ 您完全擁有資料

### **Q4: 可以隨時停用或刪除嗎？**

**可以！**
- ✅ 隨時刪除專案
- ✅ 資料可以匯出
- ✅ 不會被鎖定

### **Q5: 與本地 PostgreSQL 速度差多少？**

**輕微差異：**
- 🌐 Supabase：50-100ms（網路延遲）
- 💻 本地：5-10ms
- 📊 對 RAG 應用：幾乎感覺不到

---

## 🎉 完成檢查清單

### **基礎設定**
- [ ] Supabase 帳號已註冊
- [ ] 專案已建立
- [ ] Vector 擴展已啟用
- [ ] n8n 憑證已設定並測試成功

### **工作流程**
- [ ] 4 個工作流程已匯入
- [ ] Google Gemini 憑證已設定
- [ ] （選用）Google Drive 憑證已設定

### **功能測試**
- [ ] Workflow 1A 上傳功能正常
- [ ] 在 Supabase 看到資料
- [ ] Workflow 2A 問答功能正常
- [ ] 重啟 n8n 後資料仍存在 ✅

---

## 📚 相關資源

- [Supabase 官方文件](https://supabase.com/docs)
- [n8n Vector Store 文件](https://docs.n8n.io/integrations/builtin/cluster-nodes/root-nodes/n8n-nodes-langchain.vectorstoresupabase/)
- [PostgreSQL 文件](https://www.postgresql.org/docs/)

---

**🎓 恭喜完成 RAG 基礎版！您已經掌握了最快速的 RAG 部署方式！**

**💡 下一步**：
- 👉 繼續優化當前系統
- 👉 或挑戰 [進階版](../03_進階版_本地PostgreSQL/README.md)，學習本地 PostgreSQL！

---

*最後更新：2025-01-19*  
*版本：v2.0.0*
