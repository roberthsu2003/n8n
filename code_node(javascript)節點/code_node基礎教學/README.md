# Code Node åŸºç¤æ•™å­¸ï¼šé€éäº’å‹•å¼å¯¦ä½œå­¸ç¿’

## ğŸ“‹ ç¯„ä¾‹èªªæ˜

é€™æ˜¯ä¸€å€‹å®Œæ•´çš„äº’å‹•å¼æ•™å­¸å·¥ä½œæµç¨‹ï¼Œé€éå¯¦éš›æ¡ˆä¾‹é€æ­¥å¼•å°æ‚¨å­¸ç¿’ n8n Code Node çš„æ ¸å¿ƒæ¦‚å¿µèˆ‡é€²éšæŠ€å·§ã€‚å¾åŸºç¤çš„è³‡æ–™è™•ç†åˆ°å‘¼å«å¤–éƒ¨ APIï¼Œå†åˆ°ç”¢ç”ŸäºŒé€²ä½æª”æ¡ˆï¼Œæ¶µè“‹äº† Code Node çš„ä¸»è¦æ‡‰ç”¨å ´æ™¯ã€‚

## å·¥ä½œæµç¨‹æ¨£ç‰ˆä¸‹è¼‰

[é€éäº’å‹•å¼å¯¦ä½œæ•™å­¸å­¸ç¿’ç¨‹å¼ç¢¼javascrptç¯€é».json](é€éäº’å‹•å¼å¯¦ä½œæ•™å­¸å­¸ç¿’ç¨‹å¼ç¢¼javascrptç¯€é».json)

## ğŸ¯ ä½¿ç”¨å ´æ™¯

ç•¶æ‚¨éœ€è¦ï¼š
- **å­¸ç¿’ Code Node çš„å…©ç¨®åŸ·è¡Œæ¨¡å¼**ï¼šæ¯å€‹é …ç›®åŸ·è¡Œä¸€æ¬¡ vs. æ‰€æœ‰é …ç›®åŸ·è¡Œä¸€æ¬¡
- **æŒæ¡ n8n çš„è³‡æ–™å­˜å–æ–¹å¼**ï¼š`$input.item.json`ã€`$items()` ç­‰è®Šæ•¸çš„ä½¿ç”¨
- **å‘¼å«å¤–éƒ¨ API**ï¼šä½¿ç”¨ `this.helpers.httpRequest` é€²è¡Œå‹•æ…‹è«‹æ±‚
- **ç”¢ç”Ÿæª”æ¡ˆ**ï¼šä½¿ç”¨ `this.helpers.prepareBinaryData` å»ºç«‹ CSV ç­‰æª”æ¡ˆ
- **ç†è§£è³‡æ–™æµå‹•**ï¼šå¦‚ä½•åœ¨ç¯€é»ä¹‹é–“å‚³éå’Œè½‰æ›è³‡æ–™

## ç‚ºä»€éº¼éœ€è¦é€™å€‹æ•™å­¸ï¼Ÿ

âŒ **ç›´æ¥å­¸ç¿’æ–‡ä»¶çš„å›°å¢ƒ**ï¼š
- æ¦‚å¿µæŠ½è±¡ï¼Œç¼ºä¹å¯¦éš›æ“ä½œ
- ä¸çŸ¥é“ä½•æ™‚è©²ç”¨å“ªç¨®æ¨¡å¼
- é›£ä»¥ç†è§£è³‡æ–™çµæ§‹çš„è½‰æ›

âœ… **äº’å‹•å¼æ•™å­¸çš„å„ªå‹¢**ï¼š
- æ¯å€‹æ¦‚å¿µéƒ½æœ‰å¯¦éš›å¯åŸ·è¡Œçš„ç¯„ä¾‹
- Sticky Note æä¾›æ¸…æ™°çš„æ­¥é©Ÿèªªæ˜
- å¾ç°¡å–®åˆ°é€²éšï¼Œå¾ªåºæ¼¸é€²
- å¯ä»¥ç«‹å³çœ‹åˆ°åŸ·è¡Œçµæœ

## å·¥ä½œæµç¨‹åœ–

![å·¥ä½œæµç¨‹åœ–](./images/åŸºç¤æ•™å­¸.png)

## ğŸ“¦ å·¥ä½œæµç¨‹çµæ§‹

æ­¤æ•™å­¸å·¥ä½œæµç¨‹åŒ…å« 6 å€‹ä¸»è¦ç¯€é»å’Œ 5 å€‹èªªæ˜ Sticky Noteï¼ŒæŒ‰ç…§å­¸ç¿’é›£åº¦éé€²ï¼š

### ç¯€é»èªªæ˜

#### èµ·å§‹ç¯€é»
1. **Start Tutorial** (Manual Trigger)ï¼šæ‰‹å‹•è§¸ç™¼é–‹å§‹å­¸ç¿’
2. **1. Sample Data** (Set Node)ï¼šå»ºç«‹æ¸¬è©¦è³‡æ–™ï¼ˆ4 ä½ä½¿ç”¨è€…ï¼‰
   - `firstName`: "Alice", "Bob", "Charlie", "Alex"
   - `lastName`: "Smith", "Jones", "Brown", "Garcia"
   - `birthDate`: ä¸åŒçš„å‡ºç”Ÿæ—¥æœŸ
3. **2. Split Out Users** (Split Out Node)ï¼šå°‡ä½¿ç”¨è€…é™£åˆ—æ‹†åˆ†æˆå¤šå€‹é …ç›®

#### Lesson 1: è™•ç†æ¯å€‹é …ç›®ï¼ˆåˆç´šï¼‰
4. **3. Process Each User** (Code Node)
   - **åŸ·è¡Œæ¨¡å¼**ï¼š`runOnceForEachItem`ï¼ˆæ¯å€‹é …ç›®åŸ·è¡Œä¸€æ¬¡ï¼‰
   - **å­¸ç¿’ç›®æ¨™**ï¼š
     - ä½¿ç”¨ `$input.item.json` å­˜å–ç•¶å‰é …ç›®è³‡æ–™
     - é€²è¡Œè³‡æ–™è½‰æ›ï¼ˆçµ„åˆå…¨åã€è¨ˆç®—å¹´é½¡ï¼‰
     - ä½¿ç”¨ `return { ...user, ... }` ä¿ç•™åŸå§‹è³‡æ–™ä¸¦æ–°å¢æ¬„ä½

#### Lesson 2: å‘¼å«å¤–éƒ¨ APIï¼ˆé€²éšï¼‰
5. **4. Fetch External Data (Advanced)** (Code Node)
   - **åŸ·è¡Œæ¨¡å¼**ï¼š`runOnceForEachItem`
   - **å­¸ç¿’ç›®æ¨™**ï¼š
     - ä½¿ç”¨ `this.helpers.httpRequest` å‘¼å«å¤–éƒ¨ API
     - ç†è§£ `await` éåŒæ­¥æ“ä½œ
     - å‹•æ…‹çµ„åˆ URLï¼ˆä½¿ç”¨ä½¿ç”¨è€…åç¨±æŸ¥è©¢æ€§åˆ¥ï¼‰
     - æ•´åˆ API å›å‚³è³‡æ–™åˆ°åŸå§‹è³‡æ–™

#### Lesson 3: èšåˆæ‰€æœ‰é …ç›®ï¼ˆä¸­ç´šï¼‰
6. **5. Calculate Average Age** (Code Node)
   - **åŸ·è¡Œæ¨¡å¼**ï¼š`runOnceForAllItems`ï¼ˆæ‰€æœ‰é …ç›®åŸ·è¡Œä¸€æ¬¡ï¼‰
   - **å­¸ç¿’ç›®æ¨™**ï¼š
     - ä½¿ç”¨ `$items()` å–å¾—æ‰€æœ‰é …ç›®çš„é™£åˆ—
     - ä½¿ç”¨ `.reduce()` ç´¯åŠ è¨ˆç®—
     - å›å‚³å–®ä¸€èšåˆçµæœ `return [{ json: {...} }]`

#### Lesson 4: ç”¢ç”ŸäºŒé€²ä½æª”æ¡ˆï¼ˆå°ˆå®¶ç´šï¼‰
7. **6. Create a Binary File (Expert)** (Code Node)
   - **åŸ·è¡Œæ¨¡å¼**ï¼š`runOnceForAllItems`
   - **å­¸ç¿’ç›®æ¨™**ï¼š
     - ä½¿ç”¨ `$("ç¯€é»åç¨±").all()` å­˜å–ç‰¹å®šç¯€é»çš„è³‡æ–™
     - å‹•æ…‹ç”¢ç”Ÿ CSV å…§å®¹
     - ä½¿ç”¨ `this.helpers.prepareBinaryData` å»ºç«‹æª”æ¡ˆ
     - å›å‚³åŒ…å« `binary` å±¬æ€§çš„è³‡æ–™çµæ§‹

## ğŸ’» æ ¸å¿ƒç¨‹å¼ç¢¼è§£æ

### Lesson 1: è™•ç†æ¯å€‹é …ç›®çš„è³‡æ–™

```javascript
// åŸ·è¡Œæ¨¡å¼ï¼šrunOnceForEachItem
// æ­¤ç¨‹å¼ç¢¼æœƒç‚ºæ¯å€‹ä½¿ç”¨è€…åŸ·è¡Œä¸€æ¬¡

// 1. å–å¾—ç•¶å‰é …ç›®çš„è³‡æ–™
const user = $input.item.json;

// 2. åŸ·è¡Œè³‡æ–™è™•ç†
const fullName = `${user.firstName} ${user.lastName}`;

const birthDate = new Date(user.birthDate);
const ageDiffMs = Date.now() - birthDate.getTime();
const ageDate = new Date(ageDiffMs);
const age = Math.abs(ageDate.getUTCFullYear() - 1970);

console.log(`Processing user: ${fullName}, Age: ${age}`);

// 3. å›å‚³æ–°è³‡æ–™ï¼Œä¿ç•™åŸå§‹æ¬„ä½
return {
  ...user,  // ä¿ç•™åŸå§‹è³‡æ–™ (firstName, lastName, birthDate)
  fullName: fullName,
  age: age
};
```

### Lesson 2: å‘¼å«å¤–éƒ¨ APIï¼ˆé€²éšï¼‰

```javascript
// åŸ·è¡Œæ¨¡å¼ï¼šrunOnceForEachItem

// 1. å–å¾—ç•¶å‰é …ç›®çš„è³‡æ–™
const user = $input.item.json;

// 2. ä½¿ç”¨è¼”åŠ©å‡½æ•¸é€²è¡Œ HTTP è«‹æ±‚
// å‘¼å«å…è²» API æ ¹æ“šåå­—æ¨æ¸¬æ€§åˆ¥
const url = `https://api.genderize.io?name=${user.firstName}`;

console.log(`Fetching external data for ${user.firstName} from ${url}`)

// this.helpers.httpRequest æ˜¯å¼·å¤§çš„å…§å»ºå‡½æ•¸
// ä½¿ç”¨ 'await' å› ç‚ºé€™æ˜¯éåŒæ­¥æ“ä½œ
const response = await this.helpers.httpRequest({ 
  url: url, 
  json: true 
});

// 3. å›å‚³åŸå§‹è³‡æ–™èˆ‡æ–°çš„ API è³‡æ–™åˆä½µ
return {
  ...user,  // ä¿ç•™æ‰€æœ‰ç¾æœ‰è³‡æ–™ (fullName, age ç­‰)
  gender: response.gender,
  genderProbability: response.probability
};
```

### Lesson 3: èšåˆæ‰€æœ‰é …ç›®

```javascript
// åŸ·è¡Œæ¨¡å¼ï¼šrunOnceForAllItems
// æ­¤ç¨‹å¼ç¢¼åªåŸ·è¡Œä¸€æ¬¡ï¼Œè™•ç†æ‰€æœ‰ä½¿ç”¨è€…

// 1. å–å¾—å‰ä¸€å€‹ç¯€é»çš„æ‰€æœ‰é …ç›®
const allUsers = $items();

// 2. åŸ·è¡Œèšåˆè¨ˆç®—
const totalAge = allUsers.reduce((sum, item) => {
  return sum + item.json.age;
}, 0);

const userCount = allUsers.length;
const averageAge = totalAge / userCount;

console.log(`Calculated average age for ${userCount} users.`);

// 3. å›å‚³å–®ä¸€æ–°é …ç›®åŒ…å«çµæœ
return [
  {
    json: {
      totalUsers: userCount,
      averageAge: parseFloat(averageAge.toFixed(2))  // æ ¼å¼åŒ–åˆ°å°æ•¸é»å¾Œ 2 ä½
    }
  }
];
```

### Lesson 4: ç”¢ç”Ÿ CSV æª”æ¡ˆï¼ˆå°ˆå®¶ç´šï¼‰

```javascript
// åŸ·è¡Œæ¨¡å¼ï¼šrunOnceForAllItems

// 1. å¾ç‰¹å®šç¯€é»å–å¾—æ‰€æœ‰é …ç›®
const allUsers = $("4. Fetch External Data (Advanced)").all();

// 2. å¾è³‡æ–™å»ºç«‹ CSV å­—ä¸²
let csvContent = "FullName,Age,GenderGuess,ProcessedBy\n";  // CSV è¡¨é ­

for (const item of allUsers) {
  const user = item.json;
  const row = `"${user.fullName}",${user.age},${user.gender},n8n`;
  csvContent += row + "\n";
}

// 3. ä½¿ç”¨è¼”åŠ©å‡½æ•¸å¾å­—ä¸²å»ºç«‹äºŒé€²ä½æª”æ¡ˆ
const binaryData = await this.helpers.prepareBinaryData(
  Buffer.from(csvContent), 
  'user_report.csv'
);

// 4. å›å‚³åŒ…å«äºŒé€²ä½è³‡æ–™çš„æ–°é …ç›®
return [
  {
    json: {
      reportGenerated: new Date().toISOString(),
      userCount: allUsers.length
    },
    binary: {
      'report': binaryData
    }
  }
];
```

## ğŸ”‘ é—œéµæ¦‚å¿µå°ç…§è¡¨

| æ¦‚å¿µ | ä½¿ç”¨æ™‚æ©Ÿ | è®Šæ•¸/æ–¹æ³• | Lesson |
|------|---------|----------|--------|
| å­˜å–ç•¶å‰é …ç›® | æ¯å€‹é …ç›®åŸ·è¡Œä¸€æ¬¡ | `$input.item.json` | Lesson 1, 2 |
| å­˜å–æ‰€æœ‰é …ç›® | æ‰€æœ‰é …ç›®åŸ·è¡Œä¸€æ¬¡ | `$items()` | Lesson 3, 4 |
| å­˜å–ç‰¹å®šç¯€é»è³‡æ–™ | è·¨ç¯€é»è³‡æ–™å­˜å– | `$("ç¯€é»åç¨±").all()` | Lesson 4 |
| å‘¼å«å¤–éƒ¨ API | éœ€è¦å‹•æ…‹è«‹æ±‚æ™‚ | `this.helpers.httpRequest` | Lesson 2 |
| å»ºç«‹äºŒé€²ä½æª”æ¡ˆ | ç”¢ç”Ÿæª”æ¡ˆè¼¸å‡º | `this.helpers.prepareBinaryData` | Lesson 4 |
| ä¿ç•™åŸå§‹è³‡æ–™ | è³‡æ–™æ“´å…… | `...user` (å±•é–‹é‹ç®—å­) | Lesson 1, 2 |
| éåŒæ­¥æ“ä½œ | API å‘¼å«ã€æª”æ¡ˆè™•ç† | `await` | Lesson 2, 4 |

## ğŸ” é æœŸè¼¸å‡º

### Lesson 1 è¼¸å‡ºï¼ˆå¤šå€‹é …ç›®ï¼‰
```json
{
  "firstName": "Alice",
  "lastName": "Smith",
  "birthDate": "1990-05-15",
  "fullName": "Alice Smith",
  "age": 34
}
```

### Lesson 2 è¼¸å‡ºï¼ˆå¤šå€‹é …ç›®ï¼‰
```json
{
  "firstName": "Alice",
  "lastName": "Smith",
  "birthDate": "1990-05-15",
  "fullName": "Alice Smith",
  "age": 34,
  "gender": "female",
  "genderProbability": 0.99
}
```

### Lesson 3 è¼¸å‡ºï¼ˆå–®ä¸€é …ç›®ï¼‰
```json
{
  "totalUsers": 4,
  "averageAge": 31.25
}
```

### Lesson 4 è¼¸å‡ºï¼ˆå–®ä¸€é …ç›®å«æª”æ¡ˆï¼‰
```json
{
  "json": {
    "reportGenerated": "2024-12-11T01:43:29.000Z",
    "userCount": 4
  },
  "binary": {
    "report": {
      "data": "...",
      "fileName": "user_report.csv",
      "mimeType": "text/csv"
    }
  }
}
```

## ğŸš€ å¦‚ä½•ä½¿ç”¨

### æ­¥é©Ÿä¸€ï¼šåŒ¯å…¥å·¥ä½œæµç¨‹

1. ç™»å…¥ n8n
2. é»æ“Šã€Œæ–°å¢å·¥ä½œæµç¨‹ã€
3. é»æ“Šå³ä¸Šè§’ã€Œ...ã€é¸å–® â†’ ã€ŒåŒ¯å…¥è‡ªæª”æ¡ˆã€
4. é¸æ“‡ `é€éäº’å‹•å¼å¯¦ä½œæ•™å­¸å­¸ç¿’ç¨‹å¼ç¢¼javascrptç¯€é».json`

### æ­¥é©ŸäºŒï¼šæŒ‰é †åºå­¸ç¿’

1. **ä»”ç´°é–±è®€æ¯å€‹ Sticky Note**ï¼šå®ƒå€‘åŒ…å«è©² Lesson çš„å­¸ç¿’ç›®æ¨™å’Œé‡é»
2. **åŸ·è¡Œå·¥ä½œæµç¨‹**ï¼šé»æ“Šã€ŒåŸ·è¡Œå·¥ä½œæµç¨‹ã€æŒ‰éˆ•
3. **æŸ¥çœ‹æ¯å€‹ç¯€é»çš„è¼¸å‡º**ï¼šç†è§£è³‡æ–™å¦‚ä½•è½‰æ›
4. **é–±è®€ç¨‹å¼ç¢¼**ï¼šé›™æ“Š Code Node æŸ¥çœ‹å®Œæ•´ç¨‹å¼ç¢¼å’Œè¨»è§£
5. **å¯¦é©—ä¿®æ”¹**ï¼šå˜—è©¦ä¿®æ”¹ç¨‹å¼ç¢¼ï¼Œè§€å¯Ÿçµæœè®ŠåŒ–

### æ­¥é©Ÿä¸‰ï¼šé‡é»è§€å¯Ÿ

å»ºè­°æŒ‰ç…§ä»¥ä¸‹é †åºæª¢æŸ¥ç¯€é»è¼¸å‡ºï¼š

1. **ç¯€é» 2 (Split Out Users)**ï¼šè§€å¯Ÿå¦‚ä½•å°‡é™£åˆ—æ‹†åˆ†æˆå¤šå€‹é …ç›®
2. **ç¯€é» 3 (Process Each User)**ï¼šæª¢æŸ¥ 4 å€‹è¼¸å‡ºé …ç›®ï¼Œæ¯å€‹éƒ½æœ‰ `fullName` å’Œ `age`
3. **ç¯€é» 4 (Fetch External Data)**ï¼šæŸ¥çœ‹æ¯å€‹ä½¿ç”¨è€…æ–°å¢çš„ `gender` æ¬„ä½
4. **ç¯€é» 5 (Calculate Average Age)**ï¼šæ³¨æ„åªæœ‰ 1 å€‹è¼¸å‡ºé …ç›®åŒ…å«èšåˆçµæœ
5. **ç¯€é» 6 (Create Binary File)**ï¼šä¸‹è¼‰ç”¢ç”Ÿçš„ CSV æª”æ¡ˆæŸ¥çœ‹å…§å®¹

### æ­¥é©Ÿå››ï¼šä¿®æ”¹ç·´ç¿’

å˜—è©¦ä»¥ä¸‹ä¿®æ”¹ä¾†åŠ æ·±ç†è§£ï¼š

1. **ä¿®æ”¹ä½¿ç”¨è€…è³‡æ–™**ï¼šåœ¨ã€Œ1. Sample Dataã€ç¯€é»æ–°å¢æ›´å¤šä½¿ç”¨è€…
2. **æ”¹è®Šè¨ˆç®—é‚è¼¯**ï¼šåœ¨ Lesson 3 ä¸­è¨ˆç®—æœ€å¤§/æœ€å°å¹´é½¡è€Œéå¹³å‡å€¼
3. **å‘¼å«ä¸åŒ API**ï¼šåœ¨ Lesson 2 ä¸­å˜—è©¦å…¶ä»–å…è²» API
4. **æ”¹è®Šæª”æ¡ˆæ ¼å¼**ï¼šåœ¨ Lesson 4 ä¸­ç”¢ç”Ÿ JSON æª”æ¡ˆè€Œé CSV

## ğŸ’¡ å»¶ä¼¸ç·´ç¿’

### ç·´ç¿’ 1ï¼šæ–°å¢è³‡æ–™é©—è­‰
åœ¨ Lesson 1 ä¸­åŠ å…¥è³‡æ–™é©—è­‰ï¼š
```javascript
if (!user.firstName || !user.lastName) {
  throw new Error('å§“åæ¬„ä½ä¸å¯ç‚ºç©º');
}
```

### ç·´ç¿’ 2ï¼šè™•ç† API éŒ¯èª¤
åœ¨ Lesson 2 ä¸­åŠ å…¥éŒ¯èª¤è™•ç†ï¼š
```javascript
try {
  const response = await this.helpers.httpRequest({ url: url, json: true });
  return { ...user, gender: response.gender };
} catch (error) {
  console.error(`API å‘¼å«å¤±æ•—: ${error.message}`);
  return { ...user, gender: 'unknown' };
}
```

### ç·´ç¿’ 3ï¼šé€²éšçµ±è¨ˆ
åœ¨ Lesson 3 ä¸­å¢åŠ æ›´å¤šçµ±è¨ˆæŒ‡æ¨™ï¼š
- å¹´é½¡çš„æ¨™æº–å·®
- ç”·æ€§/å¥³æ€§çš„æ•¸é‡çµ±è¨ˆ
- æœ€å¸¸è¦‹çš„å§“æ°

### ç·´ç¿’ 4ï¼šç”¢ç”Ÿ HTML å ±è¡¨
ä¿®æ”¹ Lesson 4 ç”¢ç”Ÿ HTML æ ¼å¼çš„å ±è¡¨è€Œé CSVã€‚

### ç·´ç¿’ 5ï¼šæ•´åˆå¯¦éš›æ‡‰ç”¨
å°‡å­¸åˆ°çš„æŠ€å·§æ‡‰ç”¨åˆ°å¯¦éš›å ´æ™¯ï¼š
- å¾è³‡æ–™åº«è®€å–å®¢æˆ¶è³‡æ–™
- å‘¼å« CRM API æ›´æ–°è³‡è¨Š
- ç”¢ç”Ÿæ¯æ—¥å ±è¡¨ä¸¦å¯„é€ Email

## ğŸ“ å­¸ç¿’é‡é»

### Lesson 1 é‡é»
1. âœ… ç†è§£ `runOnceForEachItem` åŸ·è¡Œæ¨¡å¼
2. âœ… æŒæ¡ `$input.item.json` çš„ä½¿ç”¨
3. âœ… å­¸æœƒä½¿ç”¨å±•é–‹é‹ç®—å­ `...` ä¿ç•™åŸå§‹è³‡æ–™
4. âœ… ç†Ÿæ‚‰æ—¥æœŸè¨ˆç®—å’Œå­—ä¸²æ¨¡æ¿

### Lesson 2 é‡é»
1. âœ… æŒæ¡ `this.helpers.httpRequest` çš„ç”¨æ³•
2. âœ… ç†è§£ `async/await` éåŒæ­¥æ“ä½œ
3. âœ… å­¸æœƒå‹•æ…‹çµ„åˆ API URL
4. âœ… æ•´åˆå¤–éƒ¨è³‡æ–™åˆ°å·¥ä½œæµç¨‹

### Lesson 3 é‡é»
1. âœ… ç†è§£ `runOnceForAllItems` åŸ·è¡Œæ¨¡å¼
2. âœ… æŒæ¡ `$items()` çš„ä½¿ç”¨
3. âœ… ç†Ÿæ‚‰ `.reduce()` é™£åˆ—æ–¹æ³•
4. âœ… å­¸æœƒå›å‚³èšåˆçµæœçš„æ­£ç¢ºæ ¼å¼

### Lesson 4 é‡é»
1. âœ… æŒæ¡è·¨ç¯€é»è³‡æ–™å­˜å– `$("ç¯€é»åç¨±").all()`
2. âœ… å­¸æœƒä½¿ç”¨ `this.helpers.prepareBinaryData`
3. âœ… ç†è§£ `Buffer` çš„åŸºæœ¬ç”¨æ³•
4. âœ… æŒæ¡äºŒé€²ä½è³‡æ–™çš„è¼¸å‡ºæ ¼å¼

## ğŸ¤” å¸¸è¦‹å•é¡Œ

### Q1: ä½•æ™‚ä½¿ç”¨ `runOnceForEachItem` vs `runOnceForAllItems`?
- **Each Item**: ç•¶æ‚¨éœ€è¦å°æ¯å€‹é …ç›®é€²è¡Œç¨ç«‹è™•ç†ï¼ˆå¦‚è½‰æ›ã€é©—è­‰ã€API å‘¼å«ï¼‰
- **All Items**: ç•¶æ‚¨éœ€è¦èšåˆã€çµ±è¨ˆã€æˆ–ç”¢ç”Ÿå–®ä¸€è¼¸å‡º

### Q2: `$input.item.json` å’Œ `$json` æœ‰ä»€éº¼å€åˆ¥ï¼Ÿ
- `$input.item.json`: æ˜ç¢ºçš„å¯«æ³•ï¼Œæ¨è–¦ä½¿ç”¨
- `$json`: ç°¡å¯«å½¢å¼ï¼Œå…©è€…åŠŸèƒ½ç›¸åŒ

### Q3: ç‚ºä»€éº¼è¦ç”¨ `await`ï¼Ÿ
- API å‘¼å«å’Œæª”æ¡ˆæ“ä½œæ˜¯éåŒæ­¥çš„ï¼Œå¿…é ˆç­‰å¾…å®Œæˆ
- ä¸ä½¿ç”¨ `await` æœƒå¾—åˆ° Promise è€Œéå¯¦éš›çµæœ

### Q4: å¦‚ä½•é™¤éŒ¯ Code Nodeï¼Ÿ
- ä½¿ç”¨ `console.log()` è¼¸å‡ºä¸­é–“çµæœ
- æŸ¥çœ‹ n8n çš„åŸ·è¡Œè¨˜éŒ„ï¼ˆExecutionsï¼‰
- é€æ­¥åŸ·è¡Œï¼Œæª¢æŸ¥æ¯å€‹ç¯€é»çš„è¼¸å‡º

## ğŸ“š ç›¸é—œè³‡æº

- [n8n Code Node å®˜æ–¹æ–‡ä»¶](https://docs.n8n.io/code-examples/overview/)
- [JavaScript åŸºç¤æ•™å­¸](https://developer.mozilla.org/zh-TW/docs/Web/JavaScript)
- [ç¯„ä¾‹ä¸€ï¼šæ—¥æœŸæ ¼å¼æ¨™æº–åŒ–](../å°‡æ—¥æœŸæ ¼å¼æ¨™æº–åŒ–/README.md)
- [ç¯„ä¾‹äºŒï¼šå®¢æˆ¶åˆ†ç´šèˆ‡æ¨™ç±¤](../æ ¹æ“šå¤šå€‹æ¢ä»¶åˆ†é¡è³‡æ–™/README.md)
- [ç¯„ä¾‹ä¸‰ï¼šé™£åˆ—æ“ä½œèˆ‡è³‡æ–™é‡çµ„](../é™£åˆ—æ“ä½œèˆ‡è³‡æ–™é‡çµ„/README.md)

## ğŸŒŸ å­¸ç¿’è·¯å¾‘å»ºè­°

1. **å®Œæˆæœ¬æ•™å­¸** â†’ æŒæ¡ Code Node åŸºç¤æ¦‚å¿µ
2. **ç¯„ä¾‹ä¸€** â†’ ç·´ç¿’ç°¡å–®çš„è³‡æ–™è½‰æ›
3. **ç¯„ä¾‹äºŒ** â†’ å­¸ç¿’è¤‡é›œçš„æ¢ä»¶é‚è¼¯
4. **ç¯„ä¾‹ä¸‰** â†’ ç²¾é€šé™£åˆ—å’Œç‰©ä»¶æ“ä½œ
5. **å¯¦éš›å°ˆæ¡ˆ** â†’ æ‡‰ç”¨åˆ°çœŸå¯¦å·¥ä½œæµç¨‹

---

**é›£åº¦**: â­â˜†â˜† (åˆç´šï¼Œé©åˆå®Œå…¨æ–°æ‰‹)  
**é©ç”¨å°è±¡**: Code Node åˆå­¸è€…ã€æƒ³ç³»çµ±å­¸ç¿’çš„ä½¿ç”¨è€…  
**é è¨ˆå­¸ç¿’æ™‚é–“**: 60-90 åˆ†é˜  
**å‰ç½®çŸ¥è­˜**: ä¸éœ€è¦ç¨‹å¼è¨­è¨ˆåŸºç¤ï¼Œæ•™å­¸ä¸­æœƒé€æ­¥èªªæ˜

**æ•™å­¸äº®é»**:
- ğŸ“˜ äº’å‹•å¼å­¸ç¿’ï¼Œå³å­¸å³ç”¨
- ğŸ” æ¯å€‹æ¦‚å¿µéƒ½æœ‰å¯¦éš›ç¯„ä¾‹
- ğŸ“Š æ¸…æ™°çš„ Sticky Note èªªæ˜
- ğŸš€ å¾ç°¡å–®åˆ°é€²éšçš„å®Œæ•´è·¯å¾‘
- ğŸ’¡ è±å¯Œçš„å»¶ä¼¸ç·´ç¿’
