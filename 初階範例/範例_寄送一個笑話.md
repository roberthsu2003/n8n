# 初階範例
## 寄送一則笑話

### 📚 工作流程說明

這個 n8n 工作流程會在排程觸發後依序呼叫兩個外部 API：先取得勵志引言，再取得單句程式笑話。透過 Set 節點整合兩筆資料後，最後由 Gmail 節點寄送一封包含作者、類別與笑話內容的郵件，讓收件人每天收到一則輕鬆的笑話。

### 預覽圖

![](./images/pic3.png)

#### 🔄 工作流程圖

```
[便利貼說明] → [排程觸發] → [HTTP 引言] → [HTTP 程式笑話] → [整理欄位] → [寄送 Gmail]
```

#### 📋 節點詳細說明

1. **📝 Sticky Note（便利貼）**
   - **功能**：展示使用說明或流程備註，協助使用者快速了解此工作流程的目的
   - **內容重點**：提醒使用者連接 Gmail、設定排程間隔，以及如何測試

2. **⏰ Schedule Trigger（排程觸發節點）**
   - **功能**：依照設定的時間間隔自動啟動工作流程
   - **預設設定**：`Every X minutes/hours`（可依需求調整）
   - **實務建議**：先設定較短的間隔測試，確認郵件內容正確後再拉長頻率

3. **🌐 HTTP Request — 取得一個引言**
   - **目的**：從 `https://zenquotes.io/api/random` 取得隨機引言
   - **回傳資料**：JSON 陣列，包含 `q`（內容）、`a`（作者）、`h`（HTML）
   - **後續用途**：提供作者名稱，並可視需求加入引言內容

4. **🌐 HTTP Request — 取得一個程式碼的笑話**
   - **目的**：呼叫 `https://v2.jokeapi.dev/joke/Programming?blacklistFlags=nsfw,religious,political,racist,sexist,explicit&type=single` 取得單句程式笑話
   - **請求參數**：透過 `blacklistFlags` 排除不適宜內容，同時設定 `type=single` 代表僅要求 API 回傳單段文字（single-line）笑話，避免需要再組合 setup/punchline
   - **不適宜內容說明**：排除了成人向（nsfw）、宗教、政治、種族歧視、性別歧視與露骨描述等類別，確保笑話適合一般團隊或公開場合分享
   - **回傳資料**：包含 `joke`（笑話內容）與 `category`（笑話分類）

5. **🔄 Set（取出前2個網站的資料）**
   - **功能**：整合兩個 HTTP 節點的回傳結果並重新命名欄位
   - **欄位對應**：
     - `作者` ← 引言節點的 `a`
     - `笑話` ← 程式笑話節點的 `joke`
     - `類別` ← 程式笑話節點的 `category`
   - **語法範例**：`={{ $('取得一個引言').item.json.a }}` 透過節點名稱抓取前序資料

6. **📧 Gmail（發送一個笑話）**
   - **功能**：將整理好的笑話資訊寄送給指定收件人
   - **預設收件人**：`roberthsu2003@gmail.com`（可自行修改）
   - **主旨**：`這是一個笑話`
   - **郵件內容範例**：
     ```
     請看這裡的笑話
     作者:{{ $json.作者 }}
     類別:{{ $json.類別 }}
     笑話:{{ $json.笑話 }}
     ```
   - **提醒**：務必先在節點憑證中綁定 Gmail OAuth 2.0 帳號

#### 🎯 學習重點

- **排程觸發**：掌握如何使用 Schedule Trigger 讓工作流程定期執行
- **多 API 串接**：同一流程中整合多個外部資料來源
- **資料加工**：使用 Set 節點合併不同節點的 JSON 欄位
- **郵件模板**：透過 n8n 表達式插入動態內容到 Gmail 郵件
- **錯誤處理觀念**：多個 HTTP 節點串接時建議加入 Error Workflow 以提升穩定性

#### 💡 實際應用場景

- 每日自動發送程式笑話或趣味資訊給開發團隊
- 結合引言與笑話，打造具娛樂性的晨間快報
- 延伸為 Slack/Line 推播，讓團隊在聊天工具收到內容
- 配合 CRM 清單，自動與客戶建立輕鬆互動
- 替換 API 來源即可轉為「每日程式小技巧」或「安全提醒」

#### ⚙️ 設定步驟

1. **設定排程間隔**：在 Schedule Trigger 中調整觸發頻率（例如每日 09:00）
2. **確認 API 可用**：在兩個 HTTP 節點中點擊「執行節點」確認回傳 JSON 正常
3. **連接 Gmail 憑證**：於 Gmail 節點選擇已建立的 OAuth 憑證或新增一組
4. **修改收件人與主旨**：依需求更新 `sendTo`、`subject` 與郵件內容模板
5. **整體測試**：按下「執行工作流程」確認郵件成功送達並包含期望資料

---