# Docker å®¹å™¨åŒ–åŸºç¤èª²ç¨‹ (æ•´åˆç‰ˆ)

> **èª²ç¨‹å®šä½**: æ­¤èª²ç¨‹å°ˆç‚ºä½ç¨‹åº¦å­¸ç”Ÿè¨­è¨ˆ,ç›®æ¨™æ˜¯è®“å­¸ç”Ÿèƒ½å¤ ç†è§£å®¹å™¨æ¦‚å¿µ,å…·å‚™éƒ¨ç½²ã€é™¤éŒ¯ä¸¦ç¶­è­· n8n å®¹å™¨çš„èƒ½åŠ›

---

## ğŸ“š èª²ç¨‹å­¸ç¿’ç›®æ¨™

å®Œæˆæœ¬èª²ç¨‹å¾Œ,å­¸ç”Ÿèƒ½å¤ :

- ç†è§£ Docker åœ¨ n8n ä¸­æ‰®æ¼”çš„è§’è‰²
- å»ºç«‹ã€Œæ˜ è±¡æª” (Image)ã€èˆ‡ã€Œå®¹å™¨ (Container)ã€çš„åŸºæœ¬æ¦‚å¿µ
- çœ‹å¾—æ‡‚ä¸¦ä¿®æ”¹ `docker run` å’Œ `docker-compose.yml`
- çŸ¥é“ n8n çš„è³‡æ–™ç‚ºä»€éº¼æœƒæ¶ˆå¤±ã€æ€éº¼ä¿å­˜
- ä½¿ç”¨ Docker Compose ç®¡ç†å¤šæœå‹™æ‡‰ç”¨

---

## ğŸ“– èª²ç¨‹å¤§ç¶± (ç”±ç°¡è‡³é›£)

### ä¸€ã€Docker æ˜¯ä»€éº¼?ç‚ºä»€éº¼è¦å­¸?

**æ•™å­¸ç›®æ¨™**: è®“å­¸ç”Ÿå…ˆç†è§£å•é¡Œ,å†æ¥å— Docker æ˜¯è§£æ³•

#### 1. ç‚ºä»€éº¼éœ€è¦ Docker?

- **ç—›é»åˆ†æ**: å‚³çµ±éƒ¨ç½²çš„å›°å¢ƒ
  - ã€Œåœ¨æˆ‘é›»è…¦ä¸Šå¯ä»¥è·‘å•Š!ã€çš„ç¶“å…¸å•é¡Œ
  - ç’°å¢ƒä¸ä¸€è‡´ã€ä¾è³´è¡çª
  - æ›´æ–°èˆ‡ç¶­è­·çš„å™©å¤¢
  
- **n8n çš„ç‰¹æ®Šéœ€æ±‚**
  - n8n æ˜¯ä»€éº¼? (ä¸€å¥è©±: å·¥ä½œæµè‡ªå‹•åŒ–ä¼ºæœå™¨)
  - ç‚ºä»€éº¼ä¸èƒ½ã€Œç›´æ¥ä¸‹è¼‰åŸ·è¡Œã€?
    - Node.js ç‰ˆæœ¬éœ€æ±‚
    - å¥—ä»¶ä¾è³´è¤‡é›œ
    - éœ€è¦é•·æ™‚é–“é‹ä½œ
  
- **Docker è§£æ±ºäº†ä»€éº¼?**
  - ç’°å¢ƒä¸€æ¬¡å°è£å®Œæˆ
  - åˆªé™¤å¾Œå¯ä»¥å¿«é€Ÿé‡å»ºä¸€å€‹ä¸€æ¨¡ä¸€æ¨£çš„ç’°å¢ƒ
  - ã€Œå°‘å‡ºéŒ¯ã€æ¯”ã€Œæ›´å²å®³ã€æ›´é‡è¦

#### 2. è™›æ“¬æ©Ÿ (VM) vs å®¹å™¨ (Container)

- **è¦–è¦ºåŒ–æ¯”å–»**
  - **è™›æ“¬æ©Ÿ**: åƒæ˜¯ã€Œæ•´æ£Ÿæˆ¿å­ã€(åŒ…å«åœ°åŸºã€æ°´é›»ã€è£æ½¢)
  - **å®¹å™¨**: åƒæ˜¯ã€ŒIKEA æ¨£å“å±‹ã€(è¼•é‡ã€å…±ç”¨åœ°åŸºã€å¿«é€Ÿçµ„è£)
  
- **ç‚ºä»€éº¼å®¹å™¨æ¯”è¼ƒé©åˆ?**
  - å•Ÿå‹•é€Ÿåº¦å¿« (ç§’ç´š vs åˆ†é˜ç´š)
  - è³‡æºä½”ç”¨å°‘
  - æ˜“æ–¼åˆ†äº«èˆ‡è¤‡è£½

---

### äºŒã€Docker æ ¸å¿ƒæ¦‚å¿µ (åªå­¸å¿…è¦çš„ 5 å€‹åè©)

**æ•™å­¸ç›®æ¨™**: å­¸ç”Ÿèƒ½ç”¨ç™½è©±è§£é‡‹ Docker åœ¨å¹¹å˜›

#### 1. Image (æ˜ è±¡æª”) vs Container (å®¹å™¨)

- **é‡å° Python å­¸ç”Ÿçš„æ¯”å–»**
  - **Image** = `Class` (é¡åˆ¥/è¨­è¨ˆåœ–)
  - **Container** = `Instance` (å¯¦ä¾‹/å¯¦éš›ç‰©ä»¶)
  
- **é‡å°ä¸€èˆ¬å­¸ç”Ÿçš„æ¯”å–»**
  - **Image** = ã€Œé£Ÿè­œã€
  - **Container** = ç…§è‘—é£Ÿè­œåšå‡ºä¾†çš„ã€Œé€™ç›¤èœã€
  
- **é—œéµè§€å¿µ**
  - ä¸€å€‹ Image å¯ä»¥å»ºç«‹å¤šå€‹ Container
  - åˆªé™¤ Container ä¸æœƒå½±éŸ¿ Image
  - n8n image â‰  n8n container

#### 2. Volume (è³‡æ–™å·)

- **æ¯”å–»**: å¤–æ¥ç¡¬ç¢Ÿ
- **ç‚ºä»€éº¼é‡è¦?**: 
  - å®¹å™¨æ˜¯ã€Œæš«æ™‚æ€§ã€çš„
  - åˆªé™¤å®¹å™¨å¾Œ,å…§éƒ¨è³‡æ–™æœƒæ¶ˆå¤±
  - Volume è®“è³‡æ–™å¯ä»¥ã€ŒæŒä¹…ä¿å­˜ã€
  
- **å° n8n çš„æ„ç¾©**
  - Workflow çš„å„²å­˜ä½ç½®
  - å‚™ä»½çš„é—œéµ

#### 3. Port (ç«¯å£)

- **æ¯”å–»**: å°å¤–é–‹çš„é–€
- **ç‚ºä»€éº¼éœ€è¦?**
  - å®¹å™¨æ˜¯å°é–‰çš„ç’°å¢ƒ
  - Port Mapping è®“å¤–éƒ¨å¯ä»¥é€£é€²ä¾†
  
#### 4. Environment Variable (ç’°å¢ƒè®Šæ•¸)

- **æ¯”å–»**: è¨­å®šé¸é …
- **ç”¨é€”**: ä¸ä¿®æ”¹ç¨‹å¼ç¢¼,å°±èƒ½æ”¹è®Šè»Ÿé«”è¡Œç‚º

#### 5. Docker Hub

- **æ¯”å–»**: App Store
- **ç”¨é€”**: ä¸‹è¼‰åˆ¥äººæ‰“åŒ…å¥½çš„ Image

---

### ä¸‰ã€ç’°å¢ƒæº–å‚™èˆ‡å®‰è£

**æ•™å­¸ç›®æ¨™**: ç¢ºä¿æ¯ä½å­¸ç”Ÿéƒ½èƒ½æˆåŠŸå®‰è£ Docker

#### 1. å®‰è£ Docker Desktop

- **Windows / Mac**: Docker Desktop
- **Linux**: Docker Engine
- **é©—è­‰å®‰è£**: åŸ·è¡Œ `docker --version`

#### 2. è¨­å®šèˆ‡æª¢æŸ¥

- Docker Desktop ä»‹é¢å°è¦½
- ç¢ºèª Docker Daemon æ­£åœ¨é‹è¡Œ
- ç³»çµ±è³‡æºé…ç½®å»ºè­°

---

### å››ã€ç¬¬ä¸€æ¬¡åŸ·è¡Œå®¹å™¨ (Hello World)

**æ•™å­¸ç›®æ¨™**: è®“å­¸ç”Ÿè¦ªæ‰‹è·‘éç¬¬ä¸€å€‹å®¹å™¨,å»ºç«‹ä¿¡å¿ƒ

#### 1. Hello World å¯¦æˆ°

```bash
docker run hello-world
```

- **è§£è®€è¼¸å‡ºè¨Šæ¯**: ç™¼ç”Ÿäº†ä»€éº¼äº‹?
  1. Docker Client å‘ Docker Daemon ç™¼é€è«‹æ±‚(Docker ç”¨æˆ¶ç«¯æŠŠä½ çš„æŒ‡ä»¤ä¸Ÿçµ¦ Docker ä¼ºæœç¨‹å¼å»è™•ç†)
  2. Daemon æª¢æŸ¥æœ¬æ©Ÿæ˜¯å¦æœ‰ image
  3. å¾ Docker Hub (Registry) ä¸‹è¼‰ image
  4. å»ºç«‹ä¸¦åŸ·è¡Œ Container
  5. Container å°å‡ºè¨Šæ¯å¾Œè‡ªå‹•çµæŸ

#### 2. åŸºç¤æŒ‡ä»¤ç·´ç¿’

- **æŸ¥çœ‹ images**: `docker images`
- **æŸ¥çœ‹é‹è¡Œä¸­çš„ containers**: `docker ps`
- **æŸ¥çœ‹æ‰€æœ‰ containers (åŒ…å«å·²åœæ­¢)**: `docker ps -a`

**æ›´å¤š**

- **åˆªé™¤å®¹å™¨**

	- åˆªé™¤å–®ä¸€åœæ­¢çš„å®¹å™¨ï¼š

	`docker rm <å®¹å™¨IDæˆ–åç¨±>`

- **å¦‚æœå®¹å™¨é‚„åœ¨è·‘ï¼Œå¯ç”¨å¼·åˆ¶åˆªé™¤ï¼š**

  `docker rm -f <å®¹å™¨IDæˆ–åç¨±>ã€‚`
  
 - **æ¸…ç†æŒ‡ä»¤**

  - åˆªæœªä½¿ç”¨ imagesï¼š`docker image prune -a`
  - åˆªæœªä½¿ç”¨ volumesï¼š`docker volume prune`

#### 3. Docker Hub å°è¦½

- å¦‚ä½•æœå°‹ Image
- ç†è§£ Image çš„æ¨™ç±¤ (Tags)
- Official Images vs Community Images

---

### äº”ã€å¯¦æˆ°æ¼”ç·´: é‹è¡Œç¬¬ä¸€å€‹ç¶²é ä¼ºæœå™¨

**æ•™å­¸ç›®æ¨™**: ç†è§£ Port Mapping,ä¸¦æˆåŠŸåœ¨ç€è¦½å™¨çœ‹åˆ°çµæœ

#### 1. ä¸‹è¼‰ Nginx Image

```bash
docker pull nginx
```

- è§€å¯Ÿä¸‹è¼‰éç¨‹
- ç†è§£ Layer çš„æ¦‚å¿µ (ç°¡å–®æåŠå³å¯)

#### 2. å•Ÿå‹• Nginx å®¹å™¨ (åŸºç¤ç‰ˆ)

```bash
docker run nginx
```

- **å•é¡Œ**: ç‚ºä»€éº¼æ‰“ä¸é–‹ç¶²é ?
- **ç­”æ¡ˆ**: æ²’æœ‰è¨­å®š Port Mapping

#### 3. å•Ÿå‹• Nginx å®¹å™¨ (å®Œæ•´ç‰ˆ)

```bash
docker run -d -p 8080:80 nginx
```

- **åƒæ•¸è§£é‡‹**
  - `-d`: Detached mode (èƒŒæ™¯åŸ·è¡Œ)
  - `-p 8080:80`: Port Mapping (Host Port : Container Port)
  
- **æ¸¬è©¦**: ç€è¦½å™¨æ‰“é–‹ `http://localhost:8080`

#### 4. å®¹å™¨ç®¡ç†åŸºç¤

- **æŸ¥çœ‹ logs**: `docker logs <container-id>`
- **åœæ­¢å®¹å™¨**: `docker stop <container-id>`
- **å•Ÿå‹•å®¹å™¨**: `docker start <container-id>`
- **åˆªé™¤å®¹å™¨**: `docker rm <container-id>`

---

### å…­ã€è³‡æ–™æŒä¹…åŒ–: Volume çš„é‡è¦æ€§

**æ•™å­¸ç›®æ¨™**: ç†è§£å®¹å™¨çš„æš«æ™‚æ€§,å­¸æœƒä½¿ç”¨ Volume ä¿å­˜è³‡æ–™

#### 1. æ…˜ç—›æ•™è¨“æ¼”ç¤º

**æ­¥é©Ÿ**:
1. é€²å…¥æ­£åœ¨é‹è¡Œçš„ Nginx å®¹å™¨
   ```bash
   docker exec -it <container-id> bash
   ```
2. åœ¨å®¹å™¨å…§å»ºç«‹ä¸€å€‹æ¸¬è©¦æª”æ¡ˆ
   ```bash
   echo "Hello" > /usr/share/nginx/html/test.txt
   ```
3. ç¢ºèªæª”æ¡ˆå­˜åœ¨ (ç€è¦½å™¨æ‰“é–‹ `localhost:8080/test.txt`)
4. åˆªé™¤å®¹å™¨ä¸¦é‡æ–°å»ºç«‹
   ```bash
   docker rm -f <container-id>
   docker run -d -p 8080:80 nginx
   ```
5. **ç™¼ç¾**: æª”æ¡ˆæ¶ˆå¤±äº†!

#### 2. Bind Mount è§£æ±ºæ–¹æ¡ˆ

**æ­¥é©Ÿ**:
1. åœ¨æœ¬æ©Ÿå»ºç«‹æ¸¬è©¦è³‡æ–™å¤¾
   ```bash
   mkdir my-html
   echo "<h1>Hello from Host!</h1>" > my-html/index.html
   ```

2. ä½¿ç”¨ Bind Mount å•Ÿå‹•å®¹å™¨
   ```bash
   docker run -d -p 8080:80 -v $(pwd)/my-html:/usr/share/nginx/html nginx
   ```

3. **æ¸¬è©¦**:
   - ç€è¦½å™¨æŸ¥çœ‹çµæœ
   - ä¿®æ”¹æœ¬æ©Ÿçš„ `index.html`
   - é‡æ–°æ•´ç†ç€è¦½å™¨,ç«‹å³çœ‹åˆ°è®ŠåŒ–

4. **é‡é»è§€å¿µ**:
   - æœ¬æ©Ÿæª”æ¡ˆ â†” å®¹å™¨å…§æª”æ¡ˆ åŒæ­¥
   - åˆªé™¤å®¹å™¨å¾Œ,æœ¬æ©Ÿæª”æ¡ˆä»ç„¶å­˜åœ¨
   - é€™å°±æ˜¯ n8n Workflow ä¸æœƒæ¶ˆå¤±çš„é—œéµ!

#### 3. Named Volume (é€²éšé¸é …)

- **å·®ç•°**: Bind Mount vs Named Volume
- **Named Volume çš„å„ªé»**
  - Docker è‡ªå‹•ç®¡ç†ä½ç½®
  - æ›´é©åˆç”Ÿç”¢ç’°å¢ƒ

```bash
docker volume create my-data
docker run -d -p 8080:80 -v my-data:/usr/share/nginx/html nginx
```

- **åˆªé™¤ Volumeï¼š**
â€‹

	- **å…ˆçœ‹æœ‰å“ªäº› volumesï¼š**

	`docker volume ls`
â€‹

	- **åˆªé™¤æŒ‡å®šçš„ volumeï¼š**

	`docker volume rm <volume-name>`
â€‹
---

### ä¸ƒã€ç’°å¢ƒè®Šæ•¸çš„æ‡‰ç”¨

**æ•™å­¸ç›®æ¨™**: å­¸æœƒé€éç’°å¢ƒè®Šæ•¸æ§åˆ¶å®¹å™¨è¡Œç‚º

#### 1. ç‚ºä»€éº¼éœ€è¦ç’°å¢ƒè®Šæ•¸?

- ä¸ä¿®æ”¹ç¨‹å¼ç¢¼å°±èƒ½æ”¹è®Šè¨­å®š
- é©åˆä¸åŒç’°å¢ƒ (é–‹ç™¼/æ¸¬è©¦/æ­£å¼)
- æ•æ„Ÿè³‡è¨Š (å¯†ç¢¼) ä¸å¯«æ­»åœ¨ç¨‹å¼ä¸­

#### 2. å¯¦ä½œç¯„ä¾‹: MySQL å®¹å™¨

```bash
docker run -d \
  -e MYSQL_ROOT_PASSWORD=mypassword \
  -e MYSQL_DATABASE=testdb \
  mysql:8.0
```

- **è§£é‡‹**: `-e` åƒæ•¸è¨­å®šç’°å¢ƒè®Šæ•¸
- **é€£ç·šæ¸¬è©¦**: ä½¿ç”¨ MySQL client é€£ç·š

#### 3. èˆ‡ n8n çš„é—œè¯

- n8n å¸¸ç”¨ç’°å¢ƒè®Šæ•¸é å‘Š
  - `N8N_BASIC_AUTH_USER`: ç™»å…¥å¸³è™Ÿ
  - `N8N_BASIC_AUTH_PASSWORD`: ç™»å…¥å¯†ç¢¼
  - `WEBHOOK_URL`: Webhook ç¶²å€
  - `N8N_ENCRYPTION_KEY`: åŠ å¯†é‡‘é‘°

---

### å…«ã€å®¹å™¨ç¶²è·¯åŸºç¤ (é¸ä¿®)

**æ•™å­¸ç›®æ¨™**: ç†è§£å¤šå€‹å®¹å™¨å¦‚ä½•äº’ç›¸æºé€š

#### 1. å®¹å™¨ä¹‹é–“å¦‚ä½•é€£ç·š?

- é è¨­çš„ bridge ç¶²è·¯
- å®¹å™¨åç¨±ä½œç‚º hostname

#### 2. å»ºç«‹è‡ªè¨‚ç¶²è·¯

```bash
docker network create my-network
```

#### 3. å¯¦ä¾‹: é€£æ¥ Web èˆ‡ Database

```bash
# å•Ÿå‹• MySQL
docker run -d \
  --name mydb \
  --network my-network \
  -e MYSQL_ROOT_PASSWORD=pass \
  mysql:8.0

# å•Ÿå‹• Web App (å¯ä»¥é€é 'mydb' é€£ç·šåˆ°è³‡æ–™åº«)
docker run -d \
  --name webapp \
  --network my-network \
  -e DB_HOST=mydb \
  mywebapp
```

---

### ä¹ã€Docker Compose: å¾æŒ‡ä»¤åˆ°é…ç½®æª”

**æ•™å­¸ç›®æ¨™**: ç†è§£ç‚ºä»€éº¼éœ€è¦ Compose,ä¸¦èƒ½æ’°å¯«åŸºæœ¬çš„ `docker-compose.yml`

#### 1. å•é¡Œå°å‘: ç‚ºä»€éº¼ `docker run` ä¸å¤ ç”¨?

**ç—›é»**:
- æŒ‡ä»¤å¤ªé•·,å®¹æ˜“æ‰“éŒ¯
- ç„¡æ³•è¨˜ä½æ‰€æœ‰åƒæ•¸
- å¤šå€‹å®¹å™¨æ™‚,æŒ‡ä»¤æ›´è¤‡é›œ
- ä¸å¥½äº¤çµ¦åˆ¥äººä½¿ç”¨
- ç„¡æ³•ç‰ˆæœ¬æ§åˆ¶

**è§£æ±ºæ–¹æ¡ˆ**: Docker Compose
- ã€Œä¸€ä»½å¯é‡ç¾çš„èªªæ˜æ›¸ã€
- Infrastructure as Code (åŸºç¤è¨­æ–½å³ä»£ç¢¼)
- n8n æ­£å¼éƒ¨ç½²çš„æ¨™æº–åšæ³•

#### 2. YAML èªæ³•é€Ÿæˆ

- **åŸºæœ¬çµæ§‹**: ç¸®æ’çš„è—è¡“ (ä½¿ç”¨ç©ºæ ¼,ä¸ç”¨ Tab)
- **è³‡æ–™å‹æ…‹**:
  - å­—ä¸²
  - æ•¸å­—
  - åˆ—è¡¨ (ä½¿ç”¨ `-`)
  - ç‰©ä»¶ (ä½¿ç”¨ç¸®æ’)

**ç¯„ä¾‹**:
```yaml
name: John
age: 30
hobbies:
  - reading
  - coding
address:
  city: Taipei
  zipcode: 100
```

#### 3. ç¬¬ä¸€å€‹ `docker-compose.yml`

**ç›®æ¨™**: ç”¨ Compose å–ä»£ä¹‹å‰çš„ Nginx æŒ‡ä»¤

**åŸå§‹æŒ‡ä»¤**:
```bash
docker run -d -p 8080:80 -v $(pwd)/html:/usr/share/nginx/html nginx
```

**Compose ç‰ˆæœ¬**:
```yaml
version: '3.8'

services:
  web:
    image: nginx
    ports:
      - "8080:80"
    volumes:
      - ./html:/usr/share/nginx/html
```

**åŸ·è¡Œ**:
```bash
docker-compose up -d
```

#### 4. Compose å¸¸ç”¨æŒ‡ä»¤

- **å•Ÿå‹•**: `docker-compose up -d`
- **åœæ­¢**: `docker-compose down`
- **æŸ¥çœ‹ logs**: `docker-compose logs -f`
- **é‡å•Ÿ**: `docker-compose restart`
- **æŸ¥çœ‹ç‹€æ…‹**: `docker-compose ps`

---

### åã€é€²éšå¯¦æˆ°: å¤šæœå‹™æ‡‰ç”¨

**æ•™å­¸ç›®æ¨™**: æ’°å¯«åŒ…å«å¤šå€‹æœå‹™çš„ Compose æª”æ¡ˆ

#### 1. WordPress + MySQL ç¯„ä¾‹

```yaml
version: '3.8'

services:
  db:
    image: mysql:8.0
    environment:
      MYSQL_ROOT_PASSWORD: rootpass
      MYSQL_DATABASE: wordpress
      MYSQL_USER: wpuser
      MYSQL_PASSWORD: wppass
    volumes:
      - db_data:/var/lib/mysql
    
  wordpress:
    image: wordpress:latest
    ports:
      - "8080:80"
    environment:
      WORDPRESS_DB_HOST: db
      WORDPRESS_DB_USER: wpuser
      WORDPRESS_DB_PASSWORD: wppass
      WORDPRESS_DB_NAME: wordpress
    depends_on:
      - db
    volumes:
      - wp_data:/var/www/html

volumes:
  db_data:
  wp_data:
```

#### 2. é‡é»è§£é‡‹

- `depends_on`: æœå‹™å•Ÿå‹•é †åº
- æœå‹™åç¨±ä½œç‚º hostname (wordpress å¯ä»¥ç”¨ `db` é€£åˆ°è³‡æ–™åº«)
- `volumes:` å€æ®µ: å®£å‘Š Named Volume
- è³‡æ–™æŒä¹…åŒ–: å…©å€‹æœå‹™éƒ½ä½¿ç”¨ Volume

---

### åä¸€ã€n8n å°ˆç”¨ Docker æ¶æ§‹è§£æ

**æ•™å­¸ç›®æ¨™**: çœ‹æ‡‚ n8n å®˜æ–¹çš„ `docker-compose.yml`

#### 1. æœ€ç°¡å–®çš„ n8n Compose

```yaml
version: '3.8'

services:
  n8n:
    image: n8nio/n8n
    ports:
      - "5678:5678"
    environment:
      - N8N_BASIC_AUTH_ACTIVE=true
      - N8N_BASIC_AUTH_USER=admin
      - N8N_BASIC_AUTH_PASSWORD=admin123
    volumes:
      - n8n_data:/home/node/.n8n

volumes:
  n8n_data:
```

#### 2. é—œéµæ¬„ä½è§£æ

- **image**: `n8nio/n8n`
  - ä½¿ç”¨å®˜æ–¹ image
  
- **ports**: `5678:5678`
  - n8n é è¨­ä½¿ç”¨ 5678 port
  
- **volumes**: `n8n_data:/home/node/.n8n`
  - **æœ€é‡è¦!** é€™æ˜¯ Workflow çš„å„²å­˜ä½ç½®
  - åˆªé™¤å®¹å™¨å¾Œ,Workflow ä¸æœƒæ¶ˆå¤±çš„é—œéµ
  
- **environment**: 
  - å¸³è™Ÿå¯†ç¢¼è¨­å®š
  - å…¶ä»–å®¢è£½åŒ–é¸é …

#### 3. å¯¦æˆ°æ¼”ç·´

**æ­¥é©Ÿ**:
1. å»ºç«‹å°ˆæ¡ˆè³‡æ–™å¤¾
   ```bash
   mkdir n8n-demo
   cd n8n-demo
   ```

2. å»ºç«‹ `docker-compose.yml` (ä½¿ç”¨ä¸Šé¢çš„ç¯„ä¾‹)

3. å•Ÿå‹• n8n
   ```bash
   docker-compose up -d
   ```

4. è§€å¯Ÿ logs
   ```bash
   docker-compose logs -f
   ```

5. é–‹å•Ÿç€è¦½å™¨: `http://localhost:5678`

6. **æ¸¬è©¦è³‡æ–™æŒä¹…åŒ–**:
   - å»ºç«‹ä¸€å€‹ç°¡å–®çš„ Workflow
   - åŸ·è¡Œ `docker-compose down`
   - é‡æ–° `docker-compose up -d`
   - ç¢ºèª Workflow ä»ç„¶å­˜åœ¨!

---

### åäºŒã€é€²éšé…ç½®èˆ‡æœ€ä½³å¯¦è¸

**æ•™å­¸ç›®æ¨™**: å­¸ç¿’ç”Ÿç”¢ç’°å¢ƒçš„é…ç½®æŠ€å·§

#### 1. ä½¿ç”¨ `.env` æª”æ¡ˆç®¡ç†æ•æ„Ÿè³‡è¨Š

**ç‚ºä»€éº¼éœ€è¦?**
- å¯†ç¢¼ä¸æ‡‰è©²å¯«åœ¨ `docker-compose.yml` ä¸­
- æ–¹ä¾¿ä¸åŒç’°å¢ƒåˆ‡æ›
- ä¸è¦ä¸Šå‚³åˆ° Git

**ç¯„ä¾‹**:

`.env` æª”æ¡ˆ:
```
N8N_USER=admin
N8N_PASSWORD=super_secure_password
```

`docker-compose.yml`:
```yaml
version: '3.8'

services:
  n8n:
    image: n8nio/n8n
    ports:
      - "5678:5678"
    environment:
      - N8N_BASIC_AUTH_ACTIVE=true
      - N8N_BASIC_AUTH_USER=${N8N_USER}
      - N8N_BASIC_AUTH_PASSWORD=${N8N_PASSWORD}
    volumes:
      - n8n_data:/home/node/.n8n

volumes:
  n8n_data:
```

#### 2. restart ç­–ç•¥

```yaml
services:
  n8n:
    image: n8nio/n8n
    restart: always  # å®¹å™¨ç•°å¸¸é€€å‡ºæ™‚è‡ªå‹•é‡å•Ÿ
```

**é¸é …**:
- `no`: ä¸è‡ªå‹•é‡å•Ÿ (é è¨­)
- `always`: ç¸½æ˜¯é‡å•Ÿ
- `on-failure`: åªåœ¨éŒ¯èª¤æ™‚é‡å•Ÿ
- `unless-stopped`: é™¤éæ‰‹å‹•åœæ­¢,å¦å‰‡é‡å•Ÿ

#### 3. è³‡æºé™åˆ¶

```yaml
services:
  n8n:
    image: n8nio/n8n
    deploy:
      resources:
        limits:
          cpus: '1.0'
          memory: 1G
        reservations:
          memory: 512M
```

---

### åä¸‰ã€å¸¸è¦‹å•é¡Œèˆ‡é™¤éŒ¯

**æ•™å­¸ç›®æ¨™**: å­¸æœƒè‡ªè¡Œæ’é™¤å¸¸è¦‹éŒ¯èª¤

#### 1. Port å·²è¢«ä½”ç”¨

**éŒ¯èª¤è¨Šæ¯**:
```
Error: Bind for 0.0.0.0:5678 failed: port is already allocated
```

**è§£æ±ºæ–¹æ³•**:
1. æª¢æŸ¥å“ªå€‹ç¨‹å¼ä½”ç”¨ port
   ```bash
   # Mac/Linux
   lsof -i :5678
   
   # Windows
   netstat -ano | findstr :5678
   ```

2. æ”¹ç”¨å…¶ä»– port
   ```yaml
   ports:
     - "5679:5678"  # æ”¹ç”¨ 5679
   ```

#### 2. Volume æ¬Šé™å•é¡Œ (Linux/Mac)

**éŒ¯èª¤**: å®¹å™¨ç„¡æ³•å¯«å…¥ Volume

**è§£æ±ºæ–¹æ³•**:
```bash
# æª¢æŸ¥ Volume ä½ç½®
docker volume inspect n8n_data

# èª¿æ•´æ¬Šé™
sudo chown -R 1000:1000 /path/to/volume
```

#### 3. Container ä¸æ–·é‡å•Ÿ

**è¨ºæ–·æ­¥é©Ÿ**:
1. æŸ¥çœ‹ logs
   ```bash
   docker-compose logs -f
   ```

2. æª¢æŸ¥ç’°å¢ƒè®Šæ•¸æ˜¯å¦æ­£ç¢º

3. æª¢æŸ¥ Volume æ˜¯å¦æ­£å¸¸æ›è¼‰

#### 4. Image ä¸‹è¼‰å¤±æ•—

**å¯èƒ½åŸå› **:
- ç¶²è·¯å•é¡Œ
- Docker Hub é€£ç·šå•é¡Œ

**è§£æ±ºæ–¹æ³•**:
```bash
# ä½¿ç”¨é¡åƒç«™
# åœ¨ /etc/docker/daemon.json åŠ å…¥:
{
  "registry-mirrors": ["https://mirror.gcr.io"]
}
```

---

### åå››ã€å¯¦ç”¨æŠ€å·§èˆ‡æŒ‡ä»¤é€ŸæŸ¥

#### 1. æ¸…ç†æŒ‡ä»¤

```bash
# æ¸…ç†æœªä½¿ç”¨çš„ images
docker image prune -a

# æ¸…ç†æœªä½¿ç”¨çš„ volumes
docker volume prune

# æ¸…ç†æ‰€æœ‰æœªä½¿ç”¨çš„è³‡æº
docker system prune -a --volumes
```

#### 2. é€²å…¥å®¹å™¨é™¤éŒ¯

```bash
# é€²å…¥é‹è¡Œä¸­çš„å®¹å™¨
docker exec -it <container-id> sh

# æˆ–ä½¿ç”¨ bash (å¦‚æœå®¹å™¨æœ‰å®‰è£)
docker exec -it <container-id> bash
```

#### 3. è¤‡è£½æª”æ¡ˆ

```bash
# å¾å®¹å™¨è¤‡è£½åˆ°ä¸»æ©Ÿ
docker cp <container-id>:/path/to/file ./local-path

# å¾ä¸»æ©Ÿè¤‡è£½åˆ°å®¹å™¨
docker cp ./local-file <container-id>:/path/to/destination
```

#### 4. æŸ¥çœ‹å®¹å™¨è³‡æºä½¿ç”¨

```bash
# å³æ™‚ç›£æ§
docker stats

# æŸ¥çœ‹ç‰¹å®šå®¹å™¨
docker stats <container-id>
```

---

### åäº”ã€èª²ç¨‹ç¸½çµèˆ‡ä¸‹ä¸€æ­¥

#### 1. å­¸ç”Ÿæ‡‰è©²èƒ½å›ç­”çš„å•é¡Œ

- [ ] ç‚ºä»€éº¼ n8n ç”¨ Docker æ¯”è¼ƒå®‰å…¨?
- [ ] Image å’Œ Container æœ‰ä»€éº¼å·®åˆ¥?
- [ ] åˆªé™¤ Container ç‚ºä»€éº¼è³‡æ–™æœƒä¸è¦‹?
- [ ] Volume åœ¨ n8n ä¸­æ‰®æ¼”ä»€éº¼è§’è‰²?
- [ ] `docker run` å’Œ `docker-compose` å·®åœ¨å“ª?
- [ ] ç‚ºä»€éº¼æ­£å¼ç’°å¢ƒä¸ç”¨ `docker run`?
- [ ] å¦‚ä½•æŸ¥çœ‹å®¹å™¨çš„ logs?
- [ ] Port Mapping æ˜¯ä»€éº¼æ„æ€?

#### 2. é—œéµå¿ƒç†æ¨¡å‹å»ºç«‹

- Docker ä¸æ˜¯è®“ä½ æ›´å²å®³,æ˜¯è®“ä½ ã€Œå°‘å‡ºéŒ¯ã€
- n8n æ˜¯ä¸€å€‹ã€Œé•·æ™‚é–“é‹ä½œçš„æœå‹™ã€
- è³‡æ–™ä¸€å®šè¦æ”¾åœ¨ Volume
- å‡ç´š = æ› Image,ä¸æ˜¯é‡è£ç³»çµ±
- Compose æ˜¯ã€Œä¸€ä»½å¯é‡ç¾çš„èªªæ˜æ›¸ã€

#### 3. å¯¦æˆ°èƒ½åŠ›æª¢æ ¸

å­¸ç”Ÿæ‡‰è©²èƒ½å¤ :
- âœ… ç¨ç«‹å•Ÿå‹•ä¸€å€‹ n8n å®¹å™¨
- âœ… ä¿®æ”¹ `docker-compose.yml` æ”¹è®Šè¨­å®š
- âœ… æŸ¥çœ‹ä¸¦ç†è§£ logs è¨Šæ¯
- âœ… å‚™ä»½èˆ‡é‚„åŸ n8n è³‡æ–™
- âœ… æ’é™¤åŸºæœ¬çš„ port è¡çªå•é¡Œ
- âœ… ä½¿ç”¨ `.env` æª”æ¡ˆç®¡ç†å¯†ç¢¼

#### 4. ä¸‹ä¸€æ­¥å­¸ç¿’è·¯å¾‘

**åŸºç¤å·²å®Œæˆ,å¯ä»¥é€²å…¥:**
- n8n Workflow å»ºç«‹èˆ‡åŸ·è¡Œ
- é€£æ¥å¤–éƒ¨æœå‹™ (Webhook, API)
- è‡ªå‹•åŒ–å¯¦å‹™æ¡ˆä¾‹
- n8n èˆ‡ AI æ•´åˆæ‡‰ç”¨

**å¦‚æœæƒ³æ·±å…¥ Docker:**
- Docker ç¶²è·¯é€²éšé…ç½®
- è‡ªè¨‚ Dockerfile
- Multi-stage builds
- Docker Swarm / Kubernetes å…¥é–€

---

## ğŸ“ æ•™å­¸å»ºè­°èˆ‡æ³¨æ„äº‹é …

### çµ¦è¬›å¸«çš„æé†’

1. **ä¸è¦æ€¥è‘—æ•™å®Œæ‰€æœ‰æŒ‡ä»¤**
   - é‡é»æ˜¯ã€Œç†è§£æ¦‚å¿µã€,ä¸æ˜¯ã€ŒèƒŒæŒ‡ä»¤ã€
   - å­¸ç”Ÿèƒ½è§£æ±ºå•é¡Œæ¯”è¨˜ä½æŒ‡ä»¤é‡è¦

2. **å¤šç”¨æ¯”å–»èˆ‡è¦–è¦ºåŒ–**
   - ä½ç¨‹åº¦å­¸ç”Ÿéœ€è¦å…·é«”çš„é¡æ¯”
   - å¯ä»¥æº–å‚™åœ–è§£æˆ–å‹•ç•«è¼”åŠ©

3. **å³æ™‚é™¤éŒ¯ç¤ºç¯„**
   - åˆ»æ„è£½é€ éŒ¯èª¤,ç¤ºç¯„å¦‚ä½•æ’é™¤
   - è®“å­¸ç”ŸçŸ¥é“ã€Œå‡ºéŒ¯æ˜¯æ­£å¸¸çš„ã€

4. **å¼·èª¿å¯¦ä½œå‹æ–¼ç†è«–**
   - æ¯å€‹æ¦‚å¿µéƒ½è¦é…åˆå¯¦éš›æ“ä½œ
   - è®“å­¸ç”Ÿè¦ªæ‰‹æ‰“æŒ‡ä»¤,è€Œéåªæ˜¯çœ‹

5. **é€£çµåˆ° n8n çš„å¯¦éš›æ‡‰ç”¨**
   - æ¯å€‹ç« ç¯€éƒ½è¦èªªæ˜ã€Œé€™å° n8n æœ‰ä»€éº¼å¹«åŠ©ã€
   - å»ºç«‹å­¸ç¿’çš„å‹•æ©Ÿèˆ‡è„ˆçµ¡

### å¸¸è¦‹å­¸ç”Ÿå›°é›£é»

1. **æ¦‚å¿µæ··æ·†**: Image vs Container
   - **è§£æ³•**: åè¦†ä½¿ç”¨ã€ŒClass vs Instanceã€æ¯”å–»

2. **æŒ‡ä»¤ææ‡¼ç—‡**
   - **è§£æ³•**: æº–å‚™æŒ‡ä»¤å°æŠ„,å¼·èª¿ã€ŒæŸ¥è³‡æ–™ã€æ¯”ã€Œè¨˜æ†¶ã€é‡è¦

3. **YAML ç¸®æ’éŒ¯èª¤**
   - **è§£æ³•**: ä½¿ç”¨ç·šä¸Š YAML validator,ç¤ºç¯„å¦‚ä½•é™¤éŒ¯

4. **æ¬Šé™å•é¡Œ** (ç‰¹åˆ¥æ˜¯ Linux/Mac ä½¿ç”¨è€…)
   - **è§£æ³•**: äº‹å…ˆæº–å‚™æ¨™æº–çš„æ¬Šé™è¨­å®šæŒ‡ä»¤

5. **ç¶²è·¯é€£ç·šå•é¡Œ**
   - **è§£æ³•**: æº–å‚™é›¢ç·šçš„ Image æˆ–ä½¿ç”¨é¡åƒç«™

---

## ğŸ¯ æˆåŠŸæŒ‡æ¨™

1. âœ… ç¨ç«‹å¾é›¶é–‹å§‹å•Ÿå‹•ä¸€å€‹ n8n æœå‹™
2. âœ… ç†è§£ç‚ºä»€éº¼è¦ä½¿ç”¨ Volume
3. âœ… èƒ½å¤ ä¿®æ”¹ `docker-compose.yml` æ”¹è®Š port æˆ–ç’°å¢ƒè®Šæ•¸
4. âœ… é‡åˆ°éŒ¯èª¤æ™‚çŸ¥é“å¦‚ä½•æŸ¥çœ‹ logs
5. âœ… èƒ½å¤ å‘å…¶ä»–äººè§£é‡‹ Docker çš„åŸºæœ¬æ¦‚å¿µ

---




